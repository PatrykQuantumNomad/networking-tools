---
name: pentest-conventions
description: Pentesting conventions for this project -- target notation, output formats, safety rules, lab details
user-invocable: false
---

# Pentesting Conventions

Background reference for pentesting workflows in this project. Covers target notation, script output formats, safety architecture, scope configuration, lab targets, and project structure.

## Target Notation

- **IP addresses** -- Single host (10.0.0.1) or CIDR range (192.168.1.0/24)
- **Hostnames** -- Fully qualified (example.com) or short names
- **URLs** -- Full URL format (http://localhost:8080/path)
- **Localhost equivalents** -- `localhost` and `127.0.0.1` are interchangeable
- **Lab targets** -- Always use `localhost` paired to the correct port (see Lab Targets below)

## Output Expectations

Use-case scripts (`scripts/<tool>/<use-case>.sh`) support two flags:

- `-j` / `--json` -- Output structured JSON envelope (enables PostToolUse hook summary)
- `-x` / `--execute` -- Execute commands instead of displaying them

Always add `-j` when running scripts so Claude receives parsed JSON via the PostToolUse hook. Without `-j`, Claude gets raw terminal output that is harder to parse.

The `examples.sh` scripts are learning-mode only and do NOT support `-j` or `-x`.

## Safety Rules

- All commands are validated against `.pentest/scope.json` before execution
- Never run security tools directly -- always use wrapper scripts in `scripts/<tool>/`
- The PreToolUse hook blocks raw tool invocations and out-of-scope targets automatically
- Run `bash .claude/hooks/netsec-health.sh` to verify the safety architecture is operational
- The PostToolUse hook parses JSON output and provides structured summaries

## Scope File

Targets must be listed in `.pentest/scope.json` before any pentesting commands will execute.

Format:

```json
{"targets": ["localhost", "127.0.0.1"]}
```

- The scope file is gitignored (lives in `.pentest/` directory)
- Add targets only after confirming authorization to test them
- Default safe targets: localhost, 127.0.0.1

## Lab Targets

Docker-based vulnerable applications for safe practice:

| Service | URL | Credentials |
|---------|-----|-------------|
| DVWA | http://localhost:8080 | admin / password |
| Juice Shop | http://localhost:3030 | (register an account) |
| WebGoat | http://localhost:8888/WebGoat | (register an account) |
| VulnerableApp | http://localhost:8180/VulnerableApp | -- |

Manage lab containers via make targets:

- `make lab-up` -- Start all containers
- `make lab-down` -- Stop all containers
- `make lab-status` -- Show container status

## Project Structure

- `scripts/<tool>/examples.sh` -- Educational examples (10 per tool, learning mode only)
- `scripts/<tool>/<use-case>.sh` -- Task-focused scripts supporting `-j` and `-x` flags
- `scripts/common.sh` -- Shared utilities (colors, require_cmd, safety_banner, check_cmd)
- `scripts/check-tools.sh` -- Detects which of 18 pentesting tools are installed
- `labs/docker-compose.yml` -- Vulnerable Docker targets for practice
- `.claude/hooks/` -- PreToolUse and PostToolUse safety hooks
- `.claude/skills/` -- Skill files for Claude Code integration
- `.pentest/scope.json` -- Target allowlist (gitignored)
- `.pentest/audit.log` -- Audit log of all tool invocations (gitignored)
