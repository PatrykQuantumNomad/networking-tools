---
phase: 15-examples-script-migration
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - scripts/tshark/examples.sh
  - scripts/metasploit/examples.sh
  - scripts/hashcat/examples.sh
  - scripts/john/examples.sh
  - scripts/aircrack-ng/examples.sh
autonomous: true

must_haves:
  truths:
    - "Running any of the 5 migrated scripts with --help prints usage and exits 0"
    - "Running any of the 5 migrated scripts without -x produces identical educational output to pre-migration"
    - "Running any of the 5 migrated scripts with -x and piped stdin rejects with interactive terminal warning"
    - "All 50 examples across 5 scripts remain as info+echo (no run_or_show conversions)"
    - "Hashcat and john sample file creation code runs correctly after parse_common_args"
  artifacts:
    - path: "scripts/tshark/examples.sh"
      provides: "tshark dual-mode examples"
      contains: "parse_common_args"
    - path: "scripts/metasploit/examples.sh"
      provides: "metasploit dual-mode examples"
      contains: "parse_common_args"
    - path: "scripts/hashcat/examples.sh"
      provides: "hashcat dual-mode examples"
      contains: "parse_common_args"
    - path: "scripts/john/examples.sh"
      provides: "john dual-mode examples"
      contains: "parse_common_args"
    - path: "scripts/aircrack-ng/examples.sh"
      provides: "aircrack-ng dual-mode examples"
      contains: "parse_common_args"
  key_links:
    - from: "each migrated script"
      to: "scripts/lib/args.sh"
      via: "parse_common_args call"
      pattern: "parse_common_args"
---

<objective>
Migrate 5 no-target scripts to the dual-mode pattern: tshark, metasploit, hashcat, john, aircrack-ng.

Purpose: These scripts have no $TARGET variable and no examples that can be meaningfully executed via run_or_show. The migration adds flag consistency (-h/-v/-q/-x) and EXECUTE_MODE demo guarding without changing any example output.
Output: 5 scripts accepting common flags with all examples preserved as info+echo.
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-examples-script-migration/15-RESEARCH.md
@.planning/phases/14-argument-parsing-and-dual-mode-pattern/14-01-SUMMARY.md
@scripts/nmap/examples.sh (reference pattern -- already migrated)
@scripts/lib/args.sh
@scripts/lib/output.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate tshark and metasploit to dual-mode pattern</name>
  <files>
    scripts/tshark/examples.sh
    scripts/metasploit/examples.sh
  </files>
  <action>
Apply a simplified migration pattern -- these scripts have no target and no run_or_show conversions.

**For both scripts:**

1. Replace inline help check with `parse_common_args "$@"` + `set -- "${REMAINING_ARGS[@]+${REMAINING_ARGS[@]}}"`.

2. Add `confirm_execute` (no argument -- these have no target) between require_cmd and safety_banner:
   ```bash
   require_cmd <tool> "<hint>"
   confirm_execute
   safety_banner
   ```

3. Keep ALL 10 examples as info+echo -- do NOT convert any to run_or_show. These are static reference commands (tshark interface-specific, metasploit console syntax) that cannot be meaningfully executed.

4. Guard interactive demo with EXECUTE_MODE.

**tshark specifics:**
- The interactive demo is a standard `read -rp` block running `tshark -D`. Guard with EXECUTE_MODE.

**metasploit specifics:**
- The interactive section has warn/info lines but no read prompt. Still guard with EXECUTE_MODE:
  ```bash
  if [[ "${EXECUTE_MODE:-show}" == "show" ]]; then
      [[ ! -t 0 ]] && exit 0
      warn "Metasploit is interactive -- run 'msfconsole' to start."
      warn "Practice against the lab targets..."
  fi
  ```
  </action>
  <verify>
1. `bash scripts/tshark/examples.sh --help` -- exits 0
2. `bash scripts/metasploit/examples.sh --help` -- exits 0
3. `echo "" | bash scripts/tshark/examples.sh -x 2>&1` -- exits non-zero
4. `echo "" | bash scripts/metasploit/examples.sh -x 2>&1` -- exits non-zero
5. Verify zero occurrences of `run_or_show` in both files (grep returns no matches)
  </verify>
  <done>
tshark and metasploit examples.sh migrated with flag support and EXECUTE_MODE guarding. All examples preserved as info+echo.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate hashcat, john, and aircrack-ng to dual-mode pattern</name>
  <files>
    scripts/hashcat/examples.sh
    scripts/john/examples.sh
    scripts/aircrack-ng/examples.sh
  </files>
  <action>
Apply the same simplified migration pattern as Task 1.

**For all 3 scripts:**

1. Replace inline help check with `parse_common_args "$@"` + `set -- "${REMAINING_ARGS[@]+${REMAINING_ARGS[@]}}"`.
2. Add `confirm_execute` (no argument) between require_cmd and safety_banner.
3. Keep ALL examples as info+echo -- no run_or_show conversions.
4. Guard interactive demo with EXECUTE_MODE.

**hashcat specifics:**
- hashcat creates a sample directory and files before displaying examples. This side-effect code stays AFTER parse_common_args (which is correct -- `-h` exits before sample creation, which is actually improved behavior). Do NOT move the sample creation code.
- The interactive demo creates and cracks a sample hash. Guard with EXECUTE_MODE.

**john specifics:**
- john also creates sample directory/files before examples. Same as hashcat -- leave sample creation after parse_common_args.
- The interactive demo creates and cracks a sample hash file. Guard with EXECUTE_MODE.

**aircrack-ng specifics:**
- Has a `check_cmd airmon-ng` conditional block -- preserve unchanged.
- Has macOS-specific warning notes -- preserve unchanged.
- The interactive section has warn/info lines but may not have a standard read prompt. Guard with EXECUTE_MODE regardless.
  </action>
  <verify>
1. `bash scripts/hashcat/examples.sh --help` -- exits 0 (without creating sample files)
2. `bash scripts/john/examples.sh --help` -- exits 0 (without creating sample files)
3. `bash scripts/aircrack-ng/examples.sh --help` -- exits 0
4. `echo "" | bash scripts/hashcat/examples.sh -x 2>&1` -- exits non-zero
5. `echo "" | bash scripts/john/examples.sh -x 2>&1` -- exits non-zero
6. `echo "" | bash scripts/aircrack-ng/examples.sh -x 2>&1` -- exits non-zero
7. Verify zero occurrences of `run_or_show` in all 3 files
  </verify>
  <done>
hashcat, john, and aircrack-ng examples.sh migrated with flag support. Sample file creation preserved. All examples kept as info+echo.
  </done>
</task>

</tasks>

<verification>
For all 5 scripts (tshark, metasploit, hashcat, john, aircrack-ng):
1. `--help` exits 0 and prints help text
2. `-x` with piped stdin exits non-zero
3. grep confirms `parse_common_args` and `confirm_execute` in each file
4. grep confirms zero `run_or_show` calls in each file
5. hashcat and john `--help` exits without creating sample files (check no new directories created)
</verification>

<success_criteria>
All 5 no-target scripts accept dual-mode flags. Combined with Plans 01-02 and nmap, all 17 of 17 scripts are migrated.
</success_criteria>

<output>
After completion, create `.planning/phases/15-examples-script-migration/15-03-SUMMARY.md`
</output>
