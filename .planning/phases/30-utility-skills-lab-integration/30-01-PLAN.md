---
phase: 30-utility-skills-lab-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/skills/check-tools/SKILL.md
  - .claude/skills/lab/SKILL.md
  - .claude/skills/pentest-conventions/SKILL.md
autonomous: true
requirements: [UTIL-01, UTIL-02, UTIL-03]

must_haves:
  truths:
    - "User can invoke /check-tools and Claude runs scripts/check-tools.sh to show which tools are installed"
    - "User can invoke /lab start|stop|status and Claude runs the corresponding make lab-* command"
    - "Claude automatically has pentesting conventions context (target notation, output formats, safety rules) without user loading anything"
    - "check-tools and lab skills are invocable by both user and Claude (no disable-model-invocation)"
    - "pentest-conventions skill is NOT visible in user / menu but Claude can auto-invoke it"
  artifacts:
    - path: ".claude/skills/check-tools/SKILL.md"
      provides: "Check-tools utility skill wrapping scripts/check-tools.sh"
      contains: "name: check-tools"
    - path: ".claude/skills/lab/SKILL.md"
      provides: "Lab management skill wrapping make lab-up/lab-down/lab-status"
      contains: "argument-hint"
    - path: ".claude/skills/pentest-conventions/SKILL.md"
      provides: "Background conventions skill with user-invocable: false"
      contains: "user-invocable: false"
  key_links:
    - from: ".claude/skills/check-tools/SKILL.md"
      to: "scripts/check-tools.sh"
      via: "skill instructions reference script path"
      pattern: "scripts/check-tools\\.sh"
    - from: ".claude/skills/lab/SKILL.md"
      to: "Makefile"
      via: "skill instructions reference make targets"
      pattern: "make lab-(up|down|status)"
    - from: ".claude/skills/pentest-conventions/SKILL.md"
      to: "scripts/"
      via: "project structure references"
      pattern: "scripts/<tool>"
---

<objective>
Create three utility and infrastructure skills: check-tools (UTIL-01), lab management (UTIL-02), and background pentest-conventions (UTIL-03).

Purpose: Complete the non-tool skill layer so users can verify tool availability, manage Docker lab targets, and Claude automatically applies pentesting conventions without user intervention.
Output: Three SKILL.md files in .claude/skills/{check-tools,lab,pentest-conventions}/
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-utility-skills-lab-integration/30-RESEARCH.md

# Pattern reference (existing skill to match style)
@.claude/skills/nmap/SKILL.md

# Underlying scripts/config the skills wrap
@scripts/check-tools.sh
@labs/docker-compose.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create check-tools and lab utility skills</name>
  <files>.claude/skills/check-tools/SKILL.md, .claude/skills/lab/SKILL.md</files>
  <action>
Create two user-invocable utility skills. Neither uses `disable-model-invocation: true` (safe operations -- Claude should be able to auto-invoke these when relevant).

**check-tools skill** (`.claude/skills/check-tools/SKILL.md`):
- Frontmatter: `name: check-tools`, description about checking which pentesting tools are installed. No `disable-model-invocation` (allow Claude to auto-invoke when user asks "is nmap installed?").
- H1: "Check Tools"
- One-line summary: verify which pentesting tools are available on this system
- "How to Use" section with the command: `bash scripts/check-tools.sh`
- Document what the script reports: installed tools with versions, missing tools with install instructions, summary count
- "Tools Checked" section listing all 18 tools from TOOL_ORDER: nmap, tshark, msfconsole, aircrack-ng, hashcat, skipfish, sqlmap, hping3, john, nikto, foremost, dig, curl, nc, traceroute, mtr, gobuster, ffuf
- "Defaults" section: no arguments required, PATH auto-augmented for /opt/metasploit-framework/bin, /usr/local/bin, /opt/homebrew/bin
- Use double-dash (--) for markdown list descriptions to match project style

**lab skill** (`.claude/skills/lab/SKILL.md`):
- Frontmatter: `name: lab`, description about managing Docker vulnerable lab targets, `argument-hint: [start|stop|status]`. No `disable-model-invocation`.
- H1: "Lab Environment"
- One-line summary: manage the Docker-based vulnerable practice targets
- "Operations" section listing: `make lab-up` -- start, `make lab-down` -- stop, `make lab-status` -- show status
- "Lab Targets" table with correct ports from docker-compose.yml: DVWA at localhost:8080 (admin/password), Juice Shop at localhost:3030 (register), WebGoat at localhost:8888/WebGoat (register), VulnerableApp at localhost:8180/VulnerableApp (--)
- "Prerequisites" section: Docker must be running, uses docker compose v2 with labs/docker-compose.yml
- Do NOT use raw `docker-compose` or `docker compose` commands in instructions -- always use `make lab-*` targets
- Do NOT use port 3000 for Juice Shop -- the correct port is 3030
  </action>
  <verify>
Confirm both files exist and have correct frontmatter:
- `ls .claude/skills/check-tools/SKILL.md .claude/skills/lab/SKILL.md`
- check-tools has no `disable-model-invocation` in frontmatter
- lab has `argument-hint` in frontmatter
- lab references port 3030 for Juice Shop (not 3000)
- Both reference `make` or `scripts/` paths (not raw docker commands)
  </verify>
  <done>
check-tools skill references scripts/check-tools.sh with all 18 tools listed. Lab skill references make lab-up/lab-down/lab-status with correct ports (DVWA:8080, JuiceShop:3030, WebGoat:8888, VulnerableApp:8180). Neither skill has disable-model-invocation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create pentest-conventions background skill</name>
  <files>.claude/skills/pentest-conventions/SKILL.md</files>
  <action>
Create a background reference skill that Claude auto-invokes when pentesting topics arise. This skill uses `user-invocable: false` so it does NOT appear in the user's `/` command menu, but its description IS always in Claude's context.

**pentest-conventions skill** (`.claude/skills/pentest-conventions/SKILL.md`):
- Frontmatter: `name: pentest-conventions`, brief description about pentesting conventions for this project (target notation, output formats, safety rules, lab details), `user-invocable: false`
- Keep the description concise (under 150 chars) since it is always loaded into context
- H1: "Pentesting Conventions"

Content sections (keep total under 200 lines):

1. **Target Notation** -- IP addresses (10.0.0.1, 192.168.1.0/24), hostnames (example.com), URLs (http://localhost:8080), localhost equivalents (localhost and 127.0.0.1 interchangeable), lab targets always use localhost with correct port

2. **Output Expectations** -- all use-case scripts support `-j` (JSON output) and `-x` (execute mode). Always add `-j` when running scripts so Claude receives parsed JSON via PostToolUse hook. Without `-j`, Claude gets raw terminal output. `examples.sh` scripts do NOT support `-j` or `-x` (learning mode only).

3. **Safety Rules** -- all commands validated against `.pentest/scope.json` before execution. Never run security tools directly -- always use wrapper scripts in `scripts/<tool>/`. PreToolUse hook blocks raw tool invocations and out-of-scope targets. Run `bash .claude/hooks/netsec-health.sh` to verify safety architecture.

4. **Scope File** -- targets must be listed in `.pentest/scope.json` with format `{"targets":["localhost","127.0.0.1"]}`.

5. **Lab Targets** -- table with DVWA:8080, JuiceShop:3030, WebGoat:8888, VulnerableApp:8180 and credentials.

6. **Project Structure** -- brief listing: `scripts/<tool>/examples.sh` (educational examples), `scripts/<tool>/<use-case>.sh` (task scripts with -j and -x), `scripts/common.sh` (shared utilities), `labs/docker-compose.yml` (vulnerable targets), `.claude/hooks/` (safety hooks), `.claude/skills/` (skill files), `.pentest/scope.json` (target allowlist, gitignored).

Use double-dash (--) for markdown list descriptions. Keep the file focused and under 200 lines -- this content loads into Claude's context when invoked, so brevity matters.
  </action>
  <verify>
Confirm the file exists and has correct frontmatter:
- `ls .claude/skills/pentest-conventions/SKILL.md`
- Has `user-invocable: false` in frontmatter
- Does NOT have `disable-model-invocation` in frontmatter
- File is under 200 lines: `wc -l .claude/skills/pentest-conventions/SKILL.md`
- Contains sections for target notation, output expectations, safety rules, scope file, lab targets, project structure
- Lab targets table has correct port 3030 for Juice Shop
  </verify>
  <done>
pentest-conventions skill has user-invocable: false, contains all 6 convention sections (target notation, output expectations, safety rules, scope file, lab targets, project structure), is under 200 lines, and references correct ports throughout.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:
1. Verify all 3 skill directories exist: `ls -d .claude/skills/check-tools .claude/skills/lab .claude/skills/pentest-conventions`
2. Verify frontmatter patterns:
   - check-tools: has `name: check-tools`, no `disable-model-invocation`
   - lab: has `name: lab`, has `argument-hint`, no `disable-model-invocation`
   - pentest-conventions: has `name: pentest-conventions`, has `user-invocable: false`
3. Verify no stale ports: grep for "3000" in lab and pentest-conventions skills (should not appear as a port reference)
4. Verify double-dash style: grep for " -- " in all 3 skills (project convention)
5. Count total skill directories (should be 8: nmap, tshark, metasploit, sqlmap, nikto, netsec-health, check-tools, lab + pentest-conventions = 9)
</verification>

<success_criteria>
- 3 new SKILL.md files created in .claude/skills/{check-tools,lab,pentest-conventions}/
- check-tools skill wraps scripts/check-tools.sh, lists 18 tools, user and Claude can invoke
- lab skill wraps make lab-up/lab-down/lab-status with correct ports, user and Claude can invoke
- pentest-conventions skill provides background context with user-invocable: false, under 200 lines
- All skills use double-dash (--) list description convention
- No port mismatches (Juice Shop is 3030, not 3000)
</success_criteria>

<output>
After completion, create `.planning/phases/30-utility-skills-lab-integration/30-01-SUMMARY.md`
</output>
