---
phase: 16-use-case-script-migration
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - scripts/nikto/scan-specific-vulnerabilities.sh
  - scripts/nikto/scan-multiple-hosts.sh
  - scripts/nikto/scan-with-auth.sh
  - scripts/skipfish/scan-authenticated-app.sh
  - scripts/skipfish/quick-scan-web-app.sh
  - scripts/ffuf/fuzz-parameters.sh
autonomous: true

must_haves:
  truths:
    - "Running any of the 6 migrated scripts with --help prints usage and exits 0"
    - "Running any of the 6 migrated scripts without -x produces identical educational output to pre-migration"
    - "Running any of the 6 migrated scripts with -x and piped stdin rejects with interactive terminal warning"
  artifacts:
    - path: "scripts/nikto/scan-specific-vulnerabilities.sh"
      provides: "nikto specific vuln scanning dual-mode"
      contains: "parse_common_args"
    - path: "scripts/nikto/scan-multiple-hosts.sh"
      provides: "nikto multi-host scanning dual-mode"
      contains: "parse_common_args"
    - path: "scripts/nikto/scan-with-auth.sh"
      provides: "nikto authenticated scanning dual-mode"
      contains: "parse_common_args"
    - path: "scripts/skipfish/scan-authenticated-app.sh"
      provides: "skipfish authenticated scanning dual-mode"
      contains: "parse_common_args"
    - path: "scripts/skipfish/quick-scan-web-app.sh"
      provides: "skipfish quick scanning dual-mode"
      contains: "parse_common_args"
    - path: "scripts/ffuf/fuzz-parameters.sh"
      provides: "ffuf parameter fuzzing dual-mode"
      contains: "parse_common_args"
  key_links:
    - from: "each migrated script"
      to: "scripts/lib/args.sh"
      via: "parse_common_args call"
      pattern: "parse_common_args"
    - from: "each migrated script"
      to: "scripts/lib/output.sh"
      via: "run_or_show and confirm_execute calls"
      pattern: "run_or_show|confirm_execute"
---

<objective>
Migrate 6 web scanning use-case scripts to the dual-mode pattern: nikto (3 scripts), skipfish (2 scripts), ffuf (1 script).

Purpose: Web scanning tools with target-required patterns. nikto/scan-multiple-hosts and ffuf have multi-positional args (HOSTFILE, WORDLIST). skipfish/ffuf scripts have wordlist existence checks to preserve.
Output: 6 scripts accepting -h/-v/-q/-x flags with run_or_show for eligible examples.
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-use-case-script-migration/16-RESEARCH.md
@.planning/phases/15-examples-script-migration/15-01-SUMMARY.md
@scripts/nmap/examples.sh (reference pattern -- already migrated)
@scripts/lib/args.sh
@scripts/lib/output.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate nikto/scan-specific-vulnerabilities, nikto/scan-multiple-hosts, nikto/scan-with-auth</name>
  <files>
    scripts/nikto/scan-specific-vulnerabilities.sh
    scripts/nikto/scan-multiple-hosts.sh
    scripts/nikto/scan-with-auth.sh
  </files>
  <action>
Apply the proven migration pattern to each script.

**Per-script notes:**

- **scan-specific-vulnerabilities.sh**: Uses `TARGET` with default `http://localhost:8080`. All 10 examples are `nikto -h ${TARGET} ...` single commands. Convert all 10 to run_or_show. Use proper quoting: `nikto -h "$TARGET" -Tuning 1`.

- **scan-multiple-hosts.sh**: Uses `HOSTFILE="${1:-}"` as optional target (no default). This is an OPTIONAL target script -- use `confirm_execute "${1:-}"`. Examples 1 and 4 use hardcoded `localhost` -- keep as info+echo. Examples 2, 5, 6, 7, 8, 9 use `hosts.txt` or `nmap_output.xml` hardcoded filenames -- keep as info+echo. Example 3 is a pipe `nmap ... | nikto -h -` -- keep as info+echo. Example 10 is a multi-command pipeline with `&&` -- keep as info+echo. Total: 0 convertible (all use hardcoded values, not script variables). This is structural-only. The interactive demo has a complex if/else checking HOSTFILE -- wrap entire block in EXECUTE_MODE guard.

- **scan-with-auth.sh**: Uses `TARGET` with default. All 10 examples use `nikto -h ${TARGET} ...`. Example 4 uses hardcoded `http://localhost:8080` -- keep as info+echo. Examples 1-3, 5-10: 9 examples use `${TARGET}` -- convert to run_or_show. Note example 8 has `-H "Cookie: PHPSESSID=..."` with hardcoded placeholder -- this is still a valid run_or_show command, but the placeholder cookie means it won't actually work. Keep as info+echo for examples with hardcoded placeholder auth values (examples 5 with `admin:password`, 6 with `-id admin:pass`, 8 with `PHPSESSID=abc123`). Convert examples 1, 2, 3, 7, 9, 10 that use only `${TARGET}` without hardcoded credentials. Total: 6 convertible.
  </action>
  <verify>
For each of the 3 scripts, run:
1. `bash scripts/nikto/scan-specific-vulnerabilities.sh --help` -- exits 0, shows "Usage:"
2. `bash scripts/nikto/scan-multiple-hosts.sh -h` -- exits 0
3. `echo "" | bash scripts/nikto/scan-with-auth.sh -x http://localhost:8080 2>&1` -- exits non-zero, mentions "interactive terminal"
4. Verify each script contains `parse_common_args`, `confirm_execute`, and `EXECUTE_MODE`
  </verify>
  <done>
Three nikto use-case scripts accept dual-mode flags. scan-specific-vulnerabilities has 10 run_or_show. scan-multiple-hosts has 0 conversions (all hardcoded filenames/hosts). scan-with-auth has 6 run_or_show (credential-placeholder examples preserved as info+echo).
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate skipfish/scan-authenticated-app, skipfish/quick-scan-web-app, ffuf/fuzz-parameters</name>
  <files>
    scripts/skipfish/scan-authenticated-app.sh
    scripts/skipfish/quick-scan-web-app.sh
    scripts/ffuf/fuzz-parameters.sh
  </files>
  <action>
Apply the migration pattern. These scripts have multi-positional args (WORDLIST as $2) and wordlist existence checks.

**For all three scripts:** The `WORDLIST="${2:-$PROJECT_ROOT/wordlists/...}"` assignment and the `if [[ ! -f "$WORDLIST" ]]` check must remain AFTER `parse_common_args` + `set --`. Since parse_common_args strips flags and preserves positional args in REMAINING_ARGS, `$1` (TARGET) and `$2` (WORDLIST) will be restored by `set --`.

**Per-script notes:**

- **scan-authenticated-app.sh**: Uses `TARGET` and `WORDLIST`. All 10 examples are `skipfish ... ${TARGET}` single commands. Example 10 uses hardcoded `http://localhost:8080` -- keep as info+echo. Convert examples 1-9 to run_or_show. The wordlist file check must stay AFTER set -- and BEFORE safety_banner.

- **quick-scan-web-app.sh**: Same pattern. Examples 1-9 use `${TARGET}`. Example 10 is a for loop -- keep as info+echo. Convert examples 1-9 to run_or_show. Note the wordlist check is identical to scan-authenticated-app.

- **ffuf/fuzz-parameters.sh**: Uses `TARGET` and `WORDLIST`. Examine each example:
  - Examples 1-9 use `${TARGET}` and/or `${WORDLIST}` but many have embedded `FUZZ` keyword placeholders in URLs (`${TARGET}/page.php?FUZZ=test`). These are VALID executable commands -- ffuf uses `FUZZ` as the keyword marker, not a placeholder for human substitution. Convert examples 1-9 to run_or_show.
  - Example 10 uses two wordlists (`${WORDLIST}:FUZZ` and `${WORDLIST}:FUZ2`) -- this is a valid ffuf command, convert to run_or_show.
  - However, examples 3, 4 use `-d` with POST data containing `FUZZ` -- these need careful quoting. Use: `ffuf -u "$TARGET/login.php" -X POST -d "FUZZ=test" -w "$WORDLIST" -fs 0 -t 10`. All 10 convertible.

Guard all interactive demos with EXECUTE_MODE. Preserve wordlist existence checks.
  </action>
  <verify>
For each of the 3 scripts, run:
1. `bash scripts/skipfish/scan-authenticated-app.sh --help` -- exits 0, shows "Usage:"
2. `bash scripts/skipfish/quick-scan-web-app.sh -h` -- exits 0
3. Verify each script contains `parse_common_args`, `confirm_execute`, and `EXECUTE_MODE`
4. Verify the wordlist `[[ ! -f "$WORDLIST" ]]` check is preserved in all 3 scripts
  </verify>
  <done>
Three web scanning use-case scripts accept dual-mode flags. Both skipfish scripts have 9 run_or_show each (for loop preserved as info+echo). ffuf has 10 run_or_show. Wordlist existence checks preserved in all scripts.
  </done>
</task>

</tasks>

<verification>
For all 6 scripts:
1. `--help` and `-h` both exit 0 and print "Usage:"
2. Running with a target (no -x) produces educational output containing numbered examples
3. `-x` with piped stdin exits non-zero with "interactive terminal" warning
4. grep confirms `parse_common_args`, `confirm_execute`, `EXECUTE_MODE` present in each file
5. Wordlist existence checks preserved in skipfish and ffuf scripts
6. nikto/scan-multiple-hosts.sh has 0 run_or_show conversions (all hardcoded)
</verification>

<success_criteria>
All 6 nikto, skipfish, and ffuf use-case scripts accept dual-mode flags and produce backward-compatible output.
</success_criteria>

<output>
After completion, create `.planning/phases/16-use-case-script-migration/16-03-SUMMARY.md`
</output>
