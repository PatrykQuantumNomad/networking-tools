---
phase: 01-foundations-and-site-scaffold
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - site/astro.config.mjs
  - site/package.json
  - site/tsconfig.json
  - site/src/content.config.ts
  - site/src/content/docs/index.md
  - site/src/content/docs/tools/index.md
  - site/src/content/docs/guides/index.md
  - site/src/content/docs/diagnostics/index.md
  - Makefile
autonomous: true

must_haves:
  truths:
    - "Running 'make site-dev' starts the Astro dev server and the landing page renders at localhost:4321/networking-tools/ with working sidebar navigation"
    - "Running 'make site-build' produces a static build in site/dist/ with _astro/ assets intact"
    - "Running 'make site-preview' serves the production build and the landing page renders correctly with sidebar"
    - "The sidebar shows three groups: Tools, Guides, and Diagnostics"
    - "The landing page has project overview text and quick-start links"
    - "'make help' shows site-dev, site-build, site-preview targets"
  artifacts:
    - path: "site/astro.config.mjs"
      provides: "Astro + Starlight configuration with base: '/networking-tools'"
      contains: "base: '/networking-tools'"
    - path: "site/package.json"
      provides: "Node.js project with astro and @astrojs/starlight dependencies"
      contains: "@astrojs/starlight"
    - path: "site/src/content/docs/index.md"
      provides: "Landing page with project overview and quick links"
      contains: "template: splash"
    - path: "site/src/content/docs/tools/index.md"
      provides: "Placeholder page so Tools sidebar group renders"
      contains: "title:"
    - path: "site/src/content/docs/guides/index.md"
      provides: "Placeholder page so Guides sidebar group renders"
      contains: "title:"
    - path: "site/src/content/docs/diagnostics/index.md"
      provides: "Placeholder page so Diagnostics sidebar group renders"
      contains: "title:"
    - path: "Makefile"
      provides: "site-dev, site-build, site-preview targets"
      contains: "site-dev:"
  key_links:
    - from: "site/astro.config.mjs"
      to: "site/src/content/docs/"
      via: "sidebar autogenerate directories"
      pattern: "autogenerate.*directory"
    - from: "Makefile"
      to: "site/package.json"
      via: "cd site && npm run"
      pattern: "cd site && npm run"
    - from: "site/src/content/docs/index.md"
      to: "site/src/content/docs/guides/"
      via: "hero action link"
      pattern: "/networking-tools/guides/"
---

<objective>
Scaffold an Astro 5.x + Starlight documentation site in the site/ subdirectory with correct GitHub Pages base path, a landing page with project overview, sidebar navigation organized by category, and Makefile targets for site development.

Purpose: This is the documentation site that all content phases (4, 5, 6) build upon. The base path and sidebar structure must be correct from the first commit.
Output: A complete, buildable Astro Starlight site in site/ with landing page, three sidebar categories, and three Makefile targets.
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundations-and-site-scaffold/01-RESEARCH.md
@Makefile
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Astro Starlight site with correct base path and landing page</name>
  <files>
    site/astro.config.mjs
    site/package.json
    site/package-lock.json
    site/tsconfig.json
    site/src/content.config.ts
    site/src/content/docs/index.md
    site/src/content/docs/tools/index.md
    site/src/content/docs/guides/index.md
    site/src/content/docs/diagnostics/index.md
  </files>
  <action>
1. Create the `site/` directory at the repo root.

2. Initialize the Astro Starlight project using the official template:
   ```bash
   cd site
   npm create astro@latest -- --template starlight --yes .
   ```
   This generates package.json, astro.config.mjs, tsconfig.json, src/, public/.

3. **Immediately** configure `astro.config.mjs` with the correct base path and sidebar. Replace the generated config with:

   ```javascript
   // @ts-check
   import { defineConfig } from 'astro/config';
   import starlight from '@astrojs/starlight';

   export default defineConfig({
     site: 'https://patrykquantumnomad.github.io',
     base: '/networking-tools',
     integrations: [
       starlight({
         title: 'Networking Tools',
         description: 'Pentesting and network diagnostic learning lab',
         social: [
           {
             icon: 'github',
             label: 'GitHub',
             href: 'https://github.com/PatrykQuantumNomad/networking-tools',
           },
         ],
         sidebar: [
           {
             label: 'Tools',
             autogenerate: { directory: 'tools' },
           },
           {
             label: 'Guides',
             autogenerate: { directory: 'guides' },
           },
           {
             label: 'Diagnostics',
             autogenerate: { directory: 'diagnostics' },
           },
         ],
       }),
     ],
   });
   ```

   Note the GitHub username: `PatrykQuantumNomad` (from git remote). The site URL uses lowercase: `patrykquantumnomad.github.io`.

4. Verify `src/content.config.ts` uses the current Starlight content config pattern:
   ```typescript
   import { defineCollection } from 'astro:content';
   import { docsLoader } from '@astrojs/starlight/loaders';
   import { docsSchema } from '@astrojs/starlight/schema';

   export const collections = {
     docs: defineCollection({ loader: docsLoader(), schema: docsSchema() }),
   };
   ```
   If the template generated a different pattern, replace it with the above.

5. Replace the generated landing page at `src/content/docs/index.md` with:

   ```markdown
   ---
   title: Networking Tools
   description: Pentesting and network diagnostic learning lab
   template: splash
   hero:
     tagline: A collection of bash scripts demonstrating 10+ open-source security tools, networking diagnostics, and a Docker-based practice environment.
     actions:
       - text: Get Started
         link: /networking-tools/guides/
         icon: right-arrow
       - text: View on GitHub
         link: https://github.com/PatrykQuantumNomad/networking-tools
         icon: external
         variant: minimal
   ---

   ## What is this?

   Ready-to-run scripts and accessible documentation that eliminate the need to remember tool flags and configurations. Run one command, get what you need.

   ### Quick Start

   ```bash
   # Check which tools are installed
   make check

   # Start vulnerable lab targets
   make lab-up

   # Run nmap examples against a target
   make nmap TARGET=<ip>
   ```

   ### Features

   - **10+ Security Tools** -- nmap, tshark, metasploit, sqlmap, nikto, hashcat, john, hping3, aircrack-ng, skipfish, foremost
   - **28 Use-Case Scripts** -- task-focused scripts for common pentest scenarios
   - **Docker Lab** -- DVWA, Juice Shop, WebGoat, and VulnerableApp for safe practice
   - **Networking Diagnostics** -- DNS, connectivity, and performance troubleshooting
   ```

6. Create placeholder pages for each sidebar category so the autogenerate groups render:

   `src/content/docs/tools/index.md`:
   ```markdown
   ---
   title: Tools
   description: Security and networking tool references
   ---

   Documentation for each tool, including example commands, use-case scripts, and installation instructions.
   ```

   `src/content/docs/guides/index.md`:
   ```markdown
   ---
   title: Guides
   description: Getting started and learning paths
   ---

   Step-by-step guides for common tasks, from initial setup to advanced pentesting workflows.
   ```

   `src/content/docs/diagnostics/index.md`:
   ```markdown
   ---
   title: Diagnostics
   description: Network diagnostic scripts and reports
   ---

   Auto-report diagnostic scripts for DNS, connectivity, and performance troubleshooting.
   ```

7. Remove any template-generated example pages (e.g., `src/content/docs/guides/example.md`, `src/content/docs/reference/`) that do not match the project's sidebar structure. Keep only the index pages created above and the landing page.

8. Run `npm install` (if not already done by create command) and verify the build:
   ```bash
   cd site && npm run build
   ```
   Confirm that `site/dist/` is created and contains `_astro/` directory with CSS/JS assets.

9. Add `site/node_modules/` and `site/dist/` to the project's `.gitignore` if not already there.
  </action>
  <verify>
```bash
# Verify the build succeeds
cd site && npm run build

# Verify dist output exists
ls site/dist/_astro/ | head -5

# Verify base path is configured
grep "base:" site/astro.config.mjs

# Verify sidebar categories exist as pages
ls site/src/content/docs/tools/index.md
ls site/src/content/docs/guides/index.md
ls site/src/content/docs/diagnostics/index.md

# Verify landing page exists
grep "template: splash" site/src/content/docs/index.md
```
  </verify>
  <done>
- site/astro.config.mjs has `base: '/networking-tools'` and `site: 'https://patrykquantumnomad.github.io'`
- sidebar configured with Tools, Guides, Diagnostics autogenerate groups
- Landing page has project overview, quick start code block, and feature list
- Placeholder index pages exist in tools/, guides/, diagnostics/ directories
- `npm run build` in site/ succeeds and produces dist/ with _astro/ assets
- No template-generated example pages remain
  </done>
</task>

<task type="auto">
  <name>Task 2: Add namespaced site targets to Makefile with grouped help output</name>
  <files>Makefile</files>
  <action>
Add three new targets to the Makefile: `site-dev`, `site-build`, `site-preview`. These follow the namespaced prefix convention (INFRA-011) where new categories get a prefix.

Add the following block to the Makefile, after the `lab-status` target and before the `# Tool-specific runners` comment:

```makefile
# Site development
site-dev: ## Start docs site dev server
	@cd site && npm run dev

site-build: ## Build docs site for production
	@cd site && npm run build

site-preview: ## Preview docs production build
	@cd site && npm run preview
```

Also update the `.PHONY` declaration at the top of the Makefile to include the new targets:
```makefile
.PHONY: check lab-up lab-down lab-status help wordlists site-dev site-build site-preview
```

The `@` prefix suppresses the command echo (matches existing Makefile convention). The `cd site &&` pattern is preferred over npm's `--prefix` flag (per research decision).

Do NOT modify any existing targets. Do NOT rename existing targets. The namespaced convention applies only to new target categories going forward.
  </action>
  <verify>
```bash
# Verify targets exist
make -n site-dev
make -n site-build
make -n site-preview

# Verify help shows new targets
make help | grep site
```

Expected: `make help` output includes site-dev, site-build, site-preview with descriptions.
  </verify>
  <done>
- `make site-dev` runs `cd site && npm run dev`
- `make site-build` runs `cd site && npm run build`
- `make site-preview` runs `cd site && npm run preview`
- `make help` lists all three site targets with descriptions
- All existing Makefile targets remain unchanged
- .PHONY includes the new targets
  </done>
</task>

</tasks>

<verification>
1. `make site-build` completes successfully, producing `site/dist/` with `_astro/` assets
2. `make help | grep site` shows site-dev, site-build, site-preview
3. `grep "base: '/networking-tools'" site/astro.config.mjs` matches
4. `ls site/src/content/docs/{tools,guides,diagnostics}/index.md` all exist
5. `grep "template: splash" site/src/content/docs/index.md` matches
6. No template example pages remain in unexpected directories
7. All existing Makefile targets still function (spot check: `make -n check`)
</verification>

<success_criteria>
- Astro site builds successfully with `make site-build`
- Landing page renders with project overview when accessed via dev server
- Sidebar shows Tools, Guides, Diagnostics groups with placeholder pages
- Base path correctly set to `/networking-tools`
- Makefile has site-dev, site-build, site-preview targets visible in `make help`
- Existing Makefile targets unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundations-and-site-scaffold/01-02-SUMMARY.md`
</output>
