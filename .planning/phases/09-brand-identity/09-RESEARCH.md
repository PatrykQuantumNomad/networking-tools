# Phase 9: Brand Identity - Research

**Researched:** 2026-02-11
**Domain:** Starlight logo configuration, SVG favicon, brand identity for pentesting toolkit
**Confidence:** HIGH

## Summary

Phase 9 requires creating a custom SVG logo for the site header and a matching SVG favicon for the browser tab. Starlight provides built-in configuration for both: the `logo` option in `astro.config.mjs` registers header logos (rendered as `<img>` tags), and the `favicon` option points to a file in `public/`. No component overrides are needed. No new npm packages are needed.

The key implementation decision is whether to use a single SVG with embedded `prefers-color-scheme` media queries or separate dark/light SVG files. Separate files are recommended because Starlight's theme switcher uses a `data-theme` attribute, while `<img>`-embedded SVGs can only respond to OS-level `prefers-color-scheme`. If a user manually selects light mode on a dark-OS system, a single SVG would show incorrect colors. Separate dark/light files let Starlight's CSS classes handle the switching correctly.

The logo renders at 32px height on mobile (`3.5rem - 2 * 0.75rem`) and 40px on desktop (`4rem - 2 * 0.75rem`). The SVG must be clear and recognizable at these small sizes, which means simple geometric shapes -- no fine detail. The existing orange/amber accent palette (Phase 8) provides the color foundation: the site title text uses `--sl-color-text-accent` which is `hsl(38, 95%, 82%)` in dark mode and `hsl(32, 95%, 40%)` in light mode. The logo colors should harmonize with these values.

**Primary recommendation:** Create a simple, geometric SVG logo that evokes a terminal/network/security identity (e.g., terminal prompt `>_`, network node graph, or stylized shield). Use separate dark and light variants via `logo.dark`/`logo.light`. Replace `public/favicon.svg` with a matching favicon that uses embedded `prefers-color-scheme` for OS-level dark/light adaptation.

## Standard Stack

### Core

| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| @astrojs/starlight | 0.37.6 | Documentation framework with built-in logo/favicon config | Already installed. `logo` and `favicon` are first-class config options. |
| Astro | 5.17.1 | Static site generator | Already installed. Processes SVG imports from `src/assets/`. |

### Supporting

No new libraries needed. SVGs are hand-crafted or sourced, not generated by build tools.

### Alternatives Considered

| Instead of | Could Use | Tradeoff |
|------------|-----------|----------|
| Separate dark/light SVG files (`logo.dark`/`logo.light`) | Single SVG with `prefers-color-scheme` (`logo.src`) | Single file is simpler but only responds to OS-level color scheme, not Starlight's theme toggle. A user who selects light mode on a dark-OS system sees wrong logo colors. Separate files let Starlight handle switching correctly. |
| Hand-crafted SVG | Component override to inline SVG | Inlining SVG allows `currentColor` inheritance from the page CSS, but requires overriding Starlight's SiteTitle component -- more maintenance burden for a marginal benefit. Starlight's `logo.dark`/`logo.light` achieves the same result without component overrides. |
| SVG favicon with `prefers-color-scheme` | Separate .ico and .png fallbacks via `head` config | SVG favicons with embedded media queries work in Chrome 80+, Firefox 41+, Edge 80+. Safari supports SVG favicons but does not reliably apply `prefers-color-scheme` inside them. Adding an ICO fallback via `head` config handles Safari and legacy browsers. |

**Installation:**
```bash
# No new packages to install.
# Create logo files in assets, replace favicon in public:
# site/src/assets/logo-dark.svg   (header logo, dark mode)
# site/src/assets/logo-light.svg  (header logo, light mode)
# site/public/favicon.svg          (replace existing default)
```

## Architecture Patterns

### Recommended Project Structure

```
site/
  src/
    assets/
      logo-dark.svg        # Header logo for dark mode (amber on dark)
      logo-light.svg       # Header logo for light mode (dark amber on light)
    styles/
      custom.css           # Existing theme overrides (Phase 8)
  public/
    favicon.svg            # Replace default Starlight star with custom favicon
```

### Pattern 1: Separate Dark/Light Logo Registration

**What:** Register two SVG logo files via `logo.dark` and `logo.light` in `astro.config.mjs`. Starlight renders two `<img>` tags and uses CSS utility classes (`dark:sl-hidden`, `light:sl-hidden`) to show the correct one based on the active theme.

**When to use:** Always. This is the only approach that correctly responds to Starlight's theme toggle (not just OS-level preference).

**Example:**
```javascript
// Source: Starlight customization guide (https://starlight.astro.build/guides/customization/)
starlight({
  title: 'Networking Tools',
  logo: {
    dark: './src/assets/logo-dark.svg',
    light: './src/assets/logo-light.svg',
    alt: 'Networking Tools',
  },
  // ... rest of config
})
```

**How Starlight renders this (from SiteTitle.astro source):**
```html
<!-- Dark mode logo (hidden in light mode) -->
<img class="light:sl-hidden print:hidden" alt="Networking Tools"
     src="/_astro/logo-dark.xyz.svg" width="..." height="..." />
<!-- Light mode logo (hidden in dark mode) -->
<img class="dark:sl-hidden print:block" alt="Networking Tools"
     src="/_astro/logo-light.xyz.svg" width="..." height="..." />
<span>Networking Tools</span>
```

### Pattern 2: SVG Favicon with Embedded Theme Support

**What:** Replace `public/favicon.svg` with a custom SVG that uses embedded `<style>` with `@media (prefers-color-scheme: dark)` to adapt to OS-level dark/light mode.

**When to use:** For the browser tab favicon. Note: favicon responds to OS preference, not Starlight's theme toggle. This is a browser limitation, not a Starlight limitation.

**Example:**
```xml
<!-- Source: web.dev adaptive favicon guide -->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <style>
    .icon-fill { fill: #1a1a2e; }
    .icon-accent { fill: #d97706; }
    @media (prefers-color-scheme: dark) {
      .icon-fill { fill: #f5c97a; }
      .icon-accent { fill: #e8a317; }
    }
  </style>
  <!-- Icon paths here -->
</svg>
```

### Pattern 3: Favicon Config with Optional ICO Fallback

**What:** Set the `favicon` config option and optionally add an ICO fallback via `head` for Safari and legacy browsers.

**Example:**
```javascript
// Source: Starlight configuration reference
starlight({
  favicon: '/favicon.svg',
  head: [
    // Optional: ICO fallback for Safari and legacy browsers
    {
      tag: 'link',
      attrs: {
        rel: 'icon',
        href: '/favicon.ico',
        sizes: '32x32',
      },
    },
  ],
})
```

### Anti-Patterns to Avoid

- **Using `currentColor` in an SVG loaded via `<img>`:** SVGs rendered as `<img>` tags are isolated from the page's CSS cascade. `currentColor` will resolve to the SVG's own default (typically black), not the page's accent color. Use explicit fill colors in the SVG instead.
- **Single `logo.src` SVG with `prefers-color-scheme` for theme adaptation:** Only responds to OS-level color scheme, not Starlight's `data-theme` attribute. A user manually toggling theme gets the wrong logo.
- **Complex logo with fine detail at 32-40px:** The header logo renders at 32px (mobile) to 40px (desktop). Fine lines, small text, or detailed illustrations become illegible. Keep it geometric and simple.
- **Overriding the SiteTitle component just for SVG inlining:** Adds maintenance burden. Starlight's built-in `logo.dark`/`logo.light` config handles theme switching without component overrides.
- **Placing logo files in `public/` instead of `src/assets/`:** Files in `public/` are not processed by Astro's build pipeline. Files in `src/assets/` get proper asset hashing for cache busting. Starlight's `logo` config expects paths relative to the project root pointing to `src/assets/`.

## Don't Hand-Roll

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Theme-aware logo switching | Custom JavaScript or CSS to swap logo images | `logo.dark` / `logo.light` config | Starlight's SiteTitle component already handles `<img>` switching with `dark:sl-hidden`/`light:sl-hidden` utility classes. |
| Favicon configuration | Manual `<link>` tag injection in a layout override | `favicon` config option + optional `head` entries | Starlight injects the favicon `<link>` tag automatically with correct `type` attribute based on file extension. |
| Logo sizing for nav bar | Custom CSS to size the logo | Starlight's built-in `img` style: `height: calc(var(--sl-nav-height) - 2 * var(--sl-nav-pad-y))` | Logo auto-sizes to nav bar height. Design the SVG with a viewBox that looks good at 32-40px height, and Starlight handles the rest. |
| SVG optimization | Manual path simplification | SVGO (run once at authoring time) | SVGO removes metadata, collapses groups, optimizes paths. Run it once on the final SVGs before committing. |

**Key insight:** The entire brand identity implementation is configuration changes and SVG file creation. Zero JavaScript, zero component overrides, zero CSS additions beyond Phase 8's existing `custom.css`. The only code change is adding `logo` and optionally `favicon` to `astro.config.mjs`.

## Common Pitfalls

### Pitfall 1: Logo Invisible in One Theme Mode

**What goes wrong:** A dark-colored logo on a transparent background disappears against the dark mode header background. Or a light-colored logo disappears in light mode.

**Why it happens:** Using a single `logo.src` SVG with fixed colors that only work against one background shade. The dark header uses `--sl-color-gray-6` (hsl 220, 12%, 14% -- very dark), and the light header uses white/near-white.

**How to avoid:** Use separate `logo.dark` and `logo.light` SVG files. Dark mode logo uses light/amber fills (e.g., `hsl(38, 95%, 82%)` -- matching `--sl-color-accent-high`). Light mode logo uses dark fills (e.g., `hsl(28, 85%, 28%)` -- matching light mode `--sl-color-accent-high`).

**Warning signs:** Toggle theme in the Starlight header. If the logo vanishes or becomes barely visible in either mode, colors are wrong for that mode.

### Pitfall 2: Favicon Doesn't Match Starlight Theme Toggle

**What goes wrong:** User selects light mode in Starlight while OS is in dark mode. The favicon stays in dark mode style (amber on dark) while the site shows light mode.

**Why it happens:** SVG favicons with `prefers-color-scheme` respond to OS-level preference, not the site's `data-theme` attribute. This is a fundamental browser limitation -- favicons live in the browser chrome, not the page context.

**How to avoid:** Accept this limitation. It is standard behavior for all websites. The mismatch is minor (favicon in browser tab vs. page content) and not jarring enough to warrant a workaround. Document this as a known limitation, not a bug.

**Warning signs:** Testing favicon appearance when OS theme differs from Starlight theme. This is expected behavior.

### Pitfall 3: SVG viewBox Causes Distortion or Clipping

**What goes wrong:** Logo appears stretched, squished, or cut off in the nav bar.

**Why it happens:** The SVG `viewBox` aspect ratio doesn't match the intended display dimensions, or the `viewBox` is missing entirely. Starlight sets `height` on the `<img>` and `width: auto`, so the aspect ratio of the SVG determines the displayed width.

**How to avoid:** Always set an explicit `viewBox` on the SVG (e.g., `viewBox="0 0 120 32"` for a wide logo, `viewBox="0 0 32 32"` for a square icon). Design the logo to look good as a wide rectangle (for logo+text) or square (for icon-only). Starlight uses `object-fit: contain` and `object-position: 0 50%` which preserves aspect ratio and left-aligns.

**Warning signs:** Logo appears at unexpected proportions or is cropped on the sides.

### Pitfall 4: replacesTitle Harms SEO or Accessibility

**What goes wrong:** Setting `replacesTitle: true` removes the visible site title text, relying only on the `alt` attribute for accessibility. If the `alt` text is empty or generic, screen readers get no site identification.

**Why it happens:** `replacesTitle: true` adds `class="sr-only"` to the title `<span>`, hiding it visually but keeping it in the DOM for screen readers. The `alt` attribute defaults to empty string `''` if not set.

**How to avoid:** If using `replacesTitle: true`, set a meaningful `alt` text (e.g., `alt: 'Networking Tools'`). If the logo does NOT contain the project name as text, keep `replacesTitle: false` (the default) so the title text appears alongside the logo.

**Warning signs:** Using `replacesTitle: true` with a purely graphical logo that has no text in it. The site name would only be conveyed via `alt` text.

### Pitfall 5: Base Path Not Applied to Favicon

**What goes wrong:** Favicon 404s in production because the site is deployed at `/networking-tools/` but the favicon path is `/favicon.svg` (no base prefix).

**Why it happens:** Starlight's `head.ts` utility applies `fileWithBase()` to the favicon href, which prepends the configured `base` path. This happens automatically for the `favicon` config option. But if you add manual `<link>` tags via the `head` config, you must handle the base path yourself.

**How to avoid:** For the primary favicon, use the `favicon` config option (Starlight handles the base path). For fallback `<link>` tags in `head`, use paths that account for the `/networking-tools/` base, or just use root-relative paths and rely on Starlight's behavior. Starlight applies `fileWithBase()` automatically to `config.favicon.href`.

**Warning signs:** Favicon appears in `astro dev` (localhost:4321) but not in production (github.io/networking-tools/).

## Code Examples

### Complete astro.config.mjs Changes

```javascript
// Source: Starlight logo config (https://starlight.astro.build/guides/customization/)
// and favicon config (https://starlight.astro.build/reference/configuration/)
starlight({
  title: 'Networking Tools',
  description: 'Pentesting and network diagnostic learning lab',
  logo: {
    dark: './src/assets/logo-dark.svg',
    light: './src/assets/logo-light.svg',
    alt: 'Networking Tools',
  },
  // favicon defaults to '/favicon.svg' which is already correct
  // Only set explicitly if renaming:
  // favicon: '/favicon.svg',
  customCss: ['./src/styles/custom.css'],
  social: [
    {
      icon: 'github',
      label: 'GitHub',
      href: 'https://github.com/PatrykQuantumNomad/networking-tools',
    },
  ],
  sidebar: [
    { label: 'Tools', autogenerate: { directory: 'tools' } },
    { label: 'Guides', autogenerate: { directory: 'guides' } },
    { label: 'Diagnostics', autogenerate: { directory: 'diagnostics' } },
  ],
}),
```

### SVG Logo Template (Dark Mode Variant)

```xml
<!-- logo-dark.svg: Amber/light fills for dark header background -->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <!-- Design note: Use fills that match --sl-color-accent-high dark mode: hsl(38, 95%, 82%) = ~#f5c97a -->
  <!-- Keep shapes simple and geometric for clarity at 32-40px height -->
  <!-- Terminal prompt, network node, or shield motif -->
  <path fill="#f5c97a" d="..." />
</svg>
```

### SVG Logo Template (Light Mode Variant)

```xml
<!-- logo-light.svg: Dark amber fills for light header background -->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <!-- Design note: Use fills that match --sl-color-accent-high light mode: hsl(28, 85%, 28%) = ~#854d0e -->
  <path fill="#854d0e" d="..." />
</svg>
```

### SVG Favicon Template with Dark Mode Support

```xml
<!-- public/favicon.svg: Adapts to OS dark/light mode -->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
  <style>
    .primary { fill: #854d0e; }
    .accent { fill: #d97706; }
    @media (prefers-color-scheme: dark) {
      .primary { fill: #f5c97a; }
      .accent { fill: #e8a317; }
    }
  </style>
  <!-- Same icon shape as logo, adapted for 16x16 to 32x32 display -->
  <path class="primary" d="..." />
</svg>
```

### SVG Design Recommendations for Pentesting Identity

The logo should evoke "security tools / terminal / network" at a glance. Recommended motifs (in order of simplicity and recognizability at small sizes):

1. **Terminal prompt (`>_`):** The most universal symbol for command-line tools. A chevron and underscore in a rounded rectangle suggests a terminal window. Simple, works at 16px. Directly relevant to the project (bash scripts).

2. **Network node graph:** 3-4 circles connected by lines. Suggests networking. Slightly more complex but still clean at 32px.

3. **Stylized shield with terminal element:** Shield outline with `>_` inside. Combines security (shield) with tools (terminal). More complex -- may lose clarity below 24px.

4. **Angle bracket pair (`< >`):** Suggests code/markup. Very simple. May feel too generic.

**Recommendation:** Terminal prompt (`>_`) in a rounded rectangle is the strongest choice. It is:
- Immediately recognizable as a CLI/terminal tool
- Simple enough to work at 16px (favicon) through 40px (header logo)
- Easy to render as clean SVG with few paths
- Distinct from the default Starlight star/sparkle favicon

## Starlight Logo Rendering Details

### How the Logo is Sized (from SiteTitle.astro source)

```css
/* Source: site/node_modules/@astrojs/starlight/components/SiteTitle.astro */
img {
  height: calc(var(--sl-nav-height) - 2 * var(--sl-nav-pad-y));
  width: auto;
  max-width: 100%;
  object-fit: contain;
  object-position: 0 50%;
}
```

| Breakpoint | --sl-nav-height | --sl-nav-pad-y | Logo Height |
|------------|-----------------|----------------|-------------|
| Mobile     | 3.5rem (56px)   | 0.75rem (12px) | 2rem (32px) |
| Desktop    | 4rem (64px)     | 0.75rem (12px) | 2.5rem (40px) |

The logo is left-aligned (`object-position: 0 50%`) and the width scales automatically from the SVG's aspect ratio. A square `viewBox="0 0 32 32"` gives a 32x32 to 40x40 square. A wider `viewBox="0 0 120 32"` gives a wider logo.

### How Favicon is Injected (from head.ts source)

```html
<!-- Generated by Starlight's getHead() function -->
<link rel="shortcut icon"
      href="/networking-tools/favicon.svg"
      type="image/svg+xml" />
```

- Path is auto-prefixed with the `base` config (`/networking-tools/`)
- MIME type is auto-detected from file extension (`.svg` -> `image/svg+xml`)
- Default path is `/favicon.svg` if `favicon` config is not set

### Theme Switching Behavior Comparison

| Asset | Responds to Starlight theme toggle? | Responds to OS preference? | Mechanism |
|-------|-------------------------------------|----------------------------|-----------|
| Header logo (separate dark/light) | YES | Indirectly (Starlight respects OS on first load) | CSS classes `dark:sl-hidden` / `light:sl-hidden` |
| Header logo (single src) | NO | YES | SVG embedded `prefers-color-scheme` |
| Favicon | NO | YES (Chrome/Firefox only) | SVG embedded `prefers-color-scheme` |

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| Single `logo.src` with theme adaptation via CSS | Separate `logo.dark`/`logo.light` config | Starlight ~0.10+ | Correctly responds to Starlight's theme toggle, not just OS preference |
| `<link rel="shortcut icon">` | `<link rel="icon">` (but Starlight still uses `shortcut icon`) | HTML5 spec | `shortcut` is non-conforming per HTML spec but universally supported. Starlight's implementation is noted in discussion #1058 but functional. |
| .ico-only favicons | SVG favicons with embedded media queries | Chrome 80+ (2020) | SVG favicons adapt to dark/light mode, scale to any size, and are smaller files. Requires fallback for Safari. |

**Deprecated/outdated:**
- **`rel="shortcut icon"`:** Non-conforming per HTML spec, but still what Starlight generates. Not a problem in practice -- all browsers support it.
- **Raster-only favicons (.ico, .png):** Still needed as fallback for Safari and legacy browsers, but SVG is the primary format for modern browsers.

## Open Questions

1. **Exact SVG icon design**
   - What we know: The icon should use terminal/network/security motifs, be recognizable at 16-40px, and use amber/dark-amber fills matching the Phase 8 palette.
   - What's unclear: The exact path data for the SVG. This requires either hand-crafting the paths or sourcing/adapting an existing icon.
   - Recommendation: Hand-craft a minimal terminal prompt (`>_`) icon. It requires only 2-3 path elements and is straightforward SVG geometry.

2. **Whether `replacesTitle` should be true or false**
   - What we know: The logo will be a small graphical icon, not a text-based logotype. The site title "Networking Tools" provides important context.
   - What's unclear: Whether the logo icon alongside the title text looks better than the logo alone.
   - Recommendation: Keep `replacesTitle: false` (default). Show both logo icon and "Networking Tools" text. The text provides identification and the icon provides brand recognition.

3. **ICO fallback necessity**
   - What we know: SVG favicons work in Chrome 80+, Firefox 41+, Edge 80+. Safari supports SVG favicons but may not apply embedded `prefers-color-scheme`.
   - What's unclear: Whether the target audience (pentesting practitioners) uses browsers that lack SVG favicon support.
   - Recommendation: Skip the ICO fallback for now. The target audience overwhelmingly uses modern Chrome/Firefox. Safari will still show the SVG, just without dark mode adaptation. This can be added later if needed.

## Sources

### Primary (HIGH confidence)
- Starlight `SiteTitle.astro` component -- read directly from `site/node_modules/@astrojs/starlight/components/SiteTitle.astro`. Confirms logo rendered as `<img>` tags with `dark:sl-hidden`/`light:sl-hidden` classes for theme switching.
- Starlight `logo.ts` schema -- read directly from `site/node_modules/@astrojs/starlight/schemas/logo.ts`. Confirms two config shapes: `{ src, alt, replacesTitle }` or `{ dark, light, alt, replacesTitle }`.
- Starlight `favicon.ts` schema -- read directly from `site/node_modules/@astrojs/starlight/schemas/favicon.ts`. Confirms default `/favicon.svg`, supported extensions (`.ico`, `.gif`, `.jpg`, `.png`, `.svg`), and auto MIME type detection.
- Starlight `head.ts` utility -- read directly from `site/node_modules/@astrojs/starlight/utils/head.ts`. Confirms favicon is injected as `<link rel="shortcut icon">` with `fileWithBase()` for base path handling.
- Starlight `virtual-user-config.ts` -- read directly. Confirms logo imports use standard Vite resolution (separate dark/light imports or single src import).
- Starlight `props.css` -- read directly. Confirms nav height variables: `--sl-nav-height: 3.5rem` (mobile), `4rem` (desktop), `--sl-nav-pad-y: 0.75rem`.
- [Starlight Customization Guide](https://starlight.astro.build/guides/customization/) -- Official docs for logo configuration with dark/light variants.
- [Starlight Configuration Reference](https://starlight.astro.build/reference/configuration/) -- Official docs for `favicon` config option.

### Secondary (MEDIUM confidence)
- [web.dev: Building an Adaptive Favicon](https://web.dev/building-an-adaptive-favicon/) -- Best practices for SVG favicons with embedded `prefers-color-scheme`. Confirms Chrome/Firefox support, Safari limitations.
- [Starlight Discussion #955](https://github.com/withastro/starlight/discussions/955) -- Community discussion on inline SVG logos. Confirms `<img>` rendering and `prefers-color-scheme` behavior.
- [Starlight Discussion #1058](https://github.com/withastro/starlight/discussions/1058) -- Community discussion on favicon config limitations. Notes `rel="shortcut icon"` is non-conforming but functional.
- Phase 8 research and summary -- `.planning/phases/08-theme-foundation/08-RESEARCH.md` and `08-01-SUMMARY.md`. Confirms installed accent palette values.

### Tertiary (LOW confidence)
- None. All findings verified against installed source code or official documentation.

## Metadata

**Confidence breakdown:**
- Standard stack: HIGH -- Zero new dependencies. Verified logo/favicon schemas and component source code in installed `node_modules/`.
- Architecture: HIGH -- Logo rendering, sizing, and theme switching behavior verified by reading SiteTitle.astro component source, props.css, and virtual-user-config.ts.
- Pitfalls: HIGH -- Theme toggle vs. OS preference mismatch verified by reading SiteTitle.astro class logic. Base path handling verified in head.ts. SVG sizing verified in props.css.
- SVG design guidance: MEDIUM -- Design recommendations are based on general best practices for icon design at small sizes, not project-specific validation.

**Research date:** 2026-02-11
**Valid until:** 2026-03-11 (Starlight 0.37.6 is stable; logo/favicon config is fundamental and unlikely to change in minor versions)
