---
phase: 32-workflow-skills
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/skills/recon/SKILL.md
  - .claude/skills/scan/SKILL.md
  - .claude/skills/diagnose/SKILL.md
autonomous: true
requirements: [WKFL-01, WKFL-02, WKFL-03]

must_haves:
  truths:
    - "User can invoke /recon and Claude receives step-by-step instructions to run nmap host discovery, port scanning, dig DNS queries, zone transfer, curl SSL check, and gobuster subdomain enumeration"
    - "User can invoke /scan and Claude receives instructions to run nmap vuln scanning, nikto, sqlmap, and curl endpoint testing"
    - "User can invoke /diagnose and Claude receives instructions to run diagnostics/dns.sh, diagnostics/connectivity.sh, diagnostics/performance.sh (without -j -x), plus traceroute and dig (with -j -x)"
    - "All 3 skills have disable-model-invocation: true in frontmatter"
    - "All 3 skills include target validation against .pentest/scope.json and empty-argument handling"
    - "Diagnostics scripts are invoked WITHOUT -j -x flags (Pattern B scripts)"
  artifacts:
    - path: ".claude/skills/recon/SKILL.md"
      provides: "Reconnaissance workflow orchestrating 6 scripts across nmap, dig, curl, gobuster"
      contains: "disable-model-invocation: true"
    - path: ".claude/skills/scan/SKILL.md"
      provides: "Vulnerability scanning workflow orchestrating 5 scripts across nmap, nikto, sqlmap, curl"
      contains: "disable-model-invocation: true"
    - path: ".claude/skills/diagnose/SKILL.md"
      provides: "Network diagnostics workflow orchestrating 3 diagnostics scripts plus 2 tool scripts"
      contains: "disable-model-invocation: true"
  key_links:
    - from: ".claude/skills/recon/SKILL.md"
      to: "scripts/nmap/discover-live-hosts.sh, scripts/nmap/identify-ports.sh, scripts/dig/query-dns-records.sh, scripts/dig/attempt-zone-transfer.sh, scripts/curl/check-ssl-certificate.sh, scripts/gobuster/enumerate-subdomains.sh"
      via: "bash script references in numbered steps"
      pattern: "bash scripts/(nmap|dig|curl|gobuster)/"
    - from: ".claude/skills/scan/SKILL.md"
      to: "scripts/nmap/identify-ports.sh, scripts/nmap/scan-web-vulnerabilities.sh, scripts/nikto/scan-specific-vulnerabilities.sh, scripts/sqlmap/test-all-parameters.sh, scripts/curl/test-http-endpoints.sh"
      via: "bash script references in numbered steps"
      pattern: "bash scripts/(nmap|nikto|sqlmap|curl)/"
    - from: ".claude/skills/diagnose/SKILL.md"
      to: "scripts/diagnostics/dns.sh, scripts/diagnostics/connectivity.sh, scripts/diagnostics/performance.sh, scripts/traceroute/trace-network-path.sh, scripts/dig/check-dns-propagation.sh"
      via: "bash script references in numbered steps"
      pattern: "bash scripts/(diagnostics|traceroute|dig)/"
---

<objective>
Create 3 network-oriented workflow skills (/recon, /scan, /diagnose) that instruct Claude to orchestrate multi-tool pentesting workflows.

Purpose: These are the most-used pentesting workflows. /recon and /scan share nmap/nikto scripts. /diagnose uses diagnostics scripts that follow Pattern B (no -j -x flags), which requires distinct handling documented in the skill.

Output: 3 SKILL.md files in `.claude/skills/{recon,scan,diagnose}/SKILL.md`
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-workflow-skills/32-RESEARCH.md
@.claude/skills/nmap/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /recon and /scan workflow skills</name>
  <files>.claude/skills/recon/SKILL.md, .claude/skills/scan/SKILL.md</files>
  <action>
Create SKILL.md for /recon and /scan workflows. These are WORKFLOW skills, not tool skills. They provide Claude with numbered step-by-step instructions to execute multiple scripts in sequence.

**recon** (`.claude/skills/recon/SKILL.md`):
- Frontmatter: name: recon, description: "Run reconnaissance workflow -- host discovery, DNS enumeration, and OSINT gathering", argument-hint: "&lt;target&gt;", disable-model-invocation: true
- H1: "Reconnaissance Workflow"
- Purpose line: "Run comprehensive reconnaissance against the target."
- Target section: "Target: $ARGUMENTS" with guard -- "If no target was provided, ask the user for a target before proceeding. Verify the target is in `.pentest/scope.json` (run `cat .pentest/scope.json` to check). If not in scope, ask the user to add it with `/scope add &lt;target&gt;`."
- Steps section with 6 numbered steps, each with a markdown code block containing the exact bash command:
  1. Host Discovery: `bash scripts/nmap/discover-live-hosts.sh $ARGUMENTS -j -x`
  2. Port Scanning: `bash scripts/nmap/identify-ports.sh $ARGUMENTS -j -x`
  3. DNS Records: `bash scripts/dig/query-dns-records.sh $ARGUMENTS -j -x`
  4. Zone Transfer Attempt: `bash scripts/dig/attempt-zone-transfer.sh $ARGUMENTS -j -x`
  5. SSL/TLS Inspection: `bash scripts/curl/check-ssl-certificate.sh $ARGUMENTS -j -x`
  6. Subdomain Enumeration (optional): `bash scripts/gobuster/enumerate-subdomains.sh $ARGUMENTS -j -x` -- note "If gobuster is installed and target is a domain"
- "After Each Step" section: review JSON output, note findings, skip if tool not installed, adapt based on discoveries
- Summary section: structured output categories (Hosts, Ports/Services, DNS, TLS, Subdomains)

**scan** (`.claude/skills/scan/SKILL.md`):
- Frontmatter: name: scan, description: "Run vulnerability scanning workflow -- port scans, web vulnerability scans, and SQL injection testing", argument-hint: "&lt;target&gt;", disable-model-invocation: true
- H1: "Vulnerability Scanning Workflow"
- Purpose line: "Run comprehensive vulnerability scanning against the target."
- Target section: same guard pattern as /recon (check scope, ask if missing)
- Steps section with 5 numbered steps:
  1. Port and Service Scan: `bash scripts/nmap/identify-ports.sh $ARGUMENTS -j -x`
  2. Web Vulnerability Scan (nmap NSE): `bash scripts/nmap/scan-web-vulnerabilities.sh $ARGUMENTS -j -x`
  3. Web Server Analysis: `bash scripts/nikto/scan-specific-vulnerabilities.sh $ARGUMENTS -j -x`
  4. SQL Injection Testing: `bash scripts/sqlmap/test-all-parameters.sh $ARGUMENTS -j -x` -- note "Only if target is a URL with parameters"
  5. HTTP Endpoint Testing: `bash scripts/curl/test-http-endpoints.sh $ARGUMENTS -j -x`
- "After Each Step" section: same pattern as /recon
- Summary section: organized by severity (Critical, High, Medium, Low/Info)

Follow the exact research examples in 32-RESEARCH.md. Keep each skill under 200 lines. Use `$ARGUMENTS` (not hardcoded targets). All tool script references MUST include `-j -x` flags.
  </action>
  <verify>
Verify both files exist and have correct structure:
- `head -5 .claude/skills/recon/SKILL.md` shows YAML frontmatter with disable-model-invocation: true
- `head -5 .claude/skills/scan/SKILL.md` shows YAML frontmatter with disable-model-invocation: true
- `grep -c 'bash scripts/' .claude/skills/recon/SKILL.md` returns 6 (one per script step)
- `grep -c 'bash scripts/' .claude/skills/scan/SKILL.md` returns 5 (one per script step)
- `grep -c '\-j \-x' .claude/skills/recon/SKILL.md` returns 6
- `grep -c '\-j \-x' .claude/skills/scan/SKILL.md` returns 5
- `grep '$ARGUMENTS' .claude/skills/recon/SKILL.md .claude/skills/scan/SKILL.md` shows both use argument substitution
- `grep 'scope.json' .claude/skills/recon/SKILL.md .claude/skills/scan/SKILL.md` shows both check scope
  </verify>
  <done>recon and scan SKILL.md files exist with numbered steps referencing correct scripts, -j -x flags on every invocation, scope checking, and empty-argument guards</done>
</task>

<task type="auto">
  <name>Task 2: Create /diagnose workflow skill</name>
  <files>.claude/skills/diagnose/SKILL.md</files>
  <action>
Create SKILL.md for /diagnose workflow. This workflow is DIFFERENT from /recon and /scan because it uses diagnostics/ scripts that follow Pattern B (no -j, no -x flags). The skill must clearly distinguish between the two script types.

**diagnose** (`.claude/skills/diagnose/SKILL.md`):
- Frontmatter: name: diagnose, description: "Run network diagnostic workflow -- DNS, connectivity, and latency checks", argument-hint: "&lt;target&gt;", disable-model-invocation: true
- H1: "Network Diagnostics Workflow"
- Purpose line: "Run comprehensive network diagnostics against the target."
- Target section: same guard pattern (check scope, ask if missing)
- Important note before steps: "Diagnostic auto-report scripts (scripts/diagnostics/) do NOT support -j or -x flags. They run non-interactively and output directly to stdout in pass/fail/warn format. Interpret their text output directly. Tool wrapper scripts (scripts/traceroute/, scripts/dig/) support -j -x as usual."
- Steps section with 5 numbered steps:
  1. DNS Diagnostics: `bash scripts/diagnostics/dns.sh $ARGUMENTS` -- NO -j -x flags. "This diagnostic auto-report checks DNS resolution, record types, propagation across public resolvers, and reverse DNS."
  2. Connectivity Diagnostics: `bash scripts/diagnostics/connectivity.sh $ARGUMENTS` -- NO -j -x flags. "Checks ICMP reachability, TCP connectivity on common ports, and basic network path."
  3. Performance Diagnostics: `bash scripts/diagnostics/performance.sh $ARGUMENTS` -- NO -j -x flags. "Measures latency, jitter, packet loss, and bandwidth estimation."
  4. Network Path Tracing: `bash scripts/traceroute/trace-network-path.sh $ARGUMENTS -j -x` -- WITH -j -x. "Detailed traceroute/mtr analysis of the network path."
  5. DNS Propagation Check: `bash scripts/dig/check-dns-propagation.sh $ARGUMENTS -j -x` -- WITH -j -x. "Check DNS propagation across multiple resolvers."
- "After Each Step" section: note that steps 1-3 produce text output (interpret directly), steps 4-5 produce JSON output (parsed by PostToolUse hook)
- Summary section: organized by category (DNS Health, Connectivity, Performance, Network Path, Propagation)

Keep under 200 lines. Clearly mark which steps use -j -x and which do not.
  </action>
  <verify>
Verify the file exists and correctly distinguishes script types:
- `head -5 .claude/skills/diagnose/SKILL.md` shows YAML frontmatter with disable-model-invocation: true
- `grep -c 'bash scripts/' .claude/skills/diagnose/SKILL.md` returns 5 (one per script step)
- `grep 'bash scripts/diagnostics/' .claude/skills/diagnose/SKILL.md` shows 3 diagnostic scripts WITHOUT -j -x
- `grep '\-j \-x' .claude/skills/diagnose/SKILL.md` shows only 2 matches (traceroute and dig scripts)
- `grep '$ARGUMENTS' .claude/skills/diagnose/SKILL.md` confirms argument substitution
- `grep -i 'do NOT support' .claude/skills/diagnose/SKILL.md` or similar confirms the Pattern B note
  </verify>
  <done>diagnose SKILL.md exists with 5 steps, diagnostics/ scripts invoked without -j -x, tool scripts invoked with -j -x, and clear documentation distinguishing the two patterns</done>
</task>

</tasks>

<verification>
- All 3 files exist: `.claude/skills/{recon,scan,diagnose}/SKILL.md`
- All 3 have `disable-model-invocation: true` in frontmatter
- /recon references 6 scripts (nmap x2, dig x2, curl x1, gobuster x1) -- all with -j -x
- /scan references 5 scripts (nmap x2, nikto x1, sqlmap x1, curl x1) -- all with -j -x
- /diagnose references 5 scripts (diagnostics x3 WITHOUT -j -x, traceroute x1 and dig x1 WITH -j -x)
- All 3 include target scope checking and empty-argument handling
- All 3 have structured summary sections at the end
- No skill exceeds 200 lines
</verification>

<success_criteria>
- 3 workflow SKILL.md files created for /recon, /scan, /diagnose
- Each skill has numbered orchestration steps with correct script paths and flags
- /diagnose correctly handles Pattern B diagnostics scripts (no -j -x)
- All use disable-model-invocation: true
- All include scope checking and empty-argument guards
</success_criteria>

<output>
After completion, create `.planning/phases/32-workflow-skills/32-01-SUMMARY.md`
</output>
