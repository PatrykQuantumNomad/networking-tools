---
phase: 25-script-migration
plan: 03
type: execute
wave: 2
depends_on: ["25-01"]
files_modified:
  - scripts/curl/check-ssl-certificate.sh
  - scripts/curl/debug-http-response.sh
  - scripts/dig/check-dns-propagation.sh
  - scripts/foremost/analyze-forensic-image.sh
  - scripts/foremost/carve-specific-filetypes.sh
  - scripts/foremost/recover-deleted-files.sh
  - scripts/netcat/setup-listener.sh
  - scripts/netcat/transfer-files.sh
  - scripts/nikto/scan-multiple-hosts.sh
  - scripts/tshark/extract-files-from-capture.sh
autonomous: true

must_haves:
  truths:
    - "All 10 scripts produce valid JSON with -j"
    - "Each script's json_set_meta uses the correct tool, target variable, and category"
    - "All info+echo examples have corresponding json_add_example calls"
    - "Netcat scripts with NC_VARIANT branching have json_add_example inside each branch"
    - "json_finalize is placed before the interactive demo block in every script"
  artifacts:
    - path: "scripts/foremost/recover-deleted-files.sh"
      provides: "JSON support for file recovery"
      contains: "json_set_meta"
    - path: "scripts/netcat/setup-listener.sh"
      provides: "JSON support for netcat listeners with variant handling"
      contains: "json_add_example"
    - path: "scripts/curl/check-ssl-certificate.sh"
      provides: "JSON support for SSL certificate checks"
      contains: "json_finalize"
  key_links:
    - from: "scripts/netcat/setup-listener.sh"
      to: "scripts/lib/json.sh"
      via: "json_add_example inside NC_VARIANT branches"
      pattern: "json_add_example"
    - from: "scripts/foremost/*.sh"
      to: "scripts/lib/json.sh"
      via: "json_add_example for forensics examples"
      pattern: "json_add_example"
---

<objective>
Migrate 10 Group C scripts (pure info+echo) in the network-analysis, forensics, network-scanner, and web-scanner tool families to produce JSON output.

Purpose: These scripts cover the remaining pure info+echo scripts not handled by Plan 02, including the special-case netcat scripts with NC_VARIANT branching.
Output: 10 scripts producing valid JSON with all examples captured when invoked with `-j`.
</objective>

<execution_context>
@/Users/patrykattc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrykattc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-script-migration/25-RESEARCH.md
@.planning/phases/25-script-migration/25-01-SUMMARY.md
@scripts/lib/json.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate network-analysis + forensics + web scripts (curl 2, dig 1, foremost 3, nikto 1, tshark 1 = 8 scripts)</name>
  <files>
scripts/curl/check-ssl-certificate.sh
scripts/curl/debug-http-response.sh
scripts/dig/check-dns-propagation.sh
scripts/foremost/analyze-forensic-image.sh
scripts/foremost/carve-specific-filetypes.sh
scripts/foremost/recover-deleted-files.sh
scripts/nikto/scan-multiple-hosts.sh
scripts/tshark/extract-files-from-capture.sh
  </files>
  <action>
Same 3-change pattern as Plan 02:

**1. json_set_meta** with correct mapping:

| Script | Tool | Target Var | Category |
|--------|------|-----------|----------|
| curl/check-ssl-certificate.sh | curl | $TARGET | network-analysis |
| curl/debug-http-response.sh | curl | $TARGET | network-analysis |
| dig/check-dns-propagation.sh | dig | $TARGET | network-analysis |
| foremost/analyze-forensic-image.sh | foremost | $TARGET | forensics |
| foremost/carve-specific-filetypes.sh | foremost | $TARGET | forensics |
| foremost/recover-deleted-files.sh | foremost | $TARGET | forensics |
| nikto/scan-multiple-hosts.sh | nikto | $TARGET | web-scanner |
| tshark/extract-files-from-capture.sh | tshark | $TARGET | network-analysis |

Check each script for the exact primary parameter variable name. Some foremost scripts may use IMAGE or similar -- use whatever the script defines.

**2. json_add_example** for every numbered example, same pattern as Plan 02.

**3. json_finalize** before the interactive demo block.
  </action>
  <verify>
For each script, run:
```bash
bash scripts/curl/check-ssl-certificate.sh -j 3>&1 1>/dev/null 2>/dev/null | jq -e '
    .meta.tool == "curl" and
    .meta.category == "network-analysis" and
    (.results | length) >= 10
'
```
Repeat for all 8 scripts with appropriate tool/category values.
  </verify>
  <done>All 8 scripts produce valid JSON with correct meta fields and all examples captured as results.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate netcat scripts with NC_VARIANT branching (2 scripts)</name>
  <files>
scripts/netcat/setup-listener.sh
scripts/netcat/transfer-files.sh
  </files>
  <action>
These scripts are special cases because their examples branch on `$NC_VARIANT` (openbsd vs gnu). Each branch shows a different command.

**1. json_set_meta:**

| Script | Tool | Target Var | Category |
|--------|------|-----------|----------|
| netcat/setup-listener.sh | netcat | $PORT | network-scanner |
| netcat/transfer-files.sh | netcat | $TARGET | network-scanner |

**2. json_add_example with branching** — For examples that have NC_VARIANT conditionals, place `json_add_example` inside each branch:

```bash
info "1) Basic listener on port ${PORT}"
if [[ "$NC_VARIANT" == "openbsd" ]]; then
    echo "   nc -l ${PORT}"
    json_add_example "1) Basic listener on port ${PORT}" "nc -l ${PORT}"
else
    echo "   nc -l -p ${PORT}"
    json_add_example "1) Basic listener on port ${PORT}" "nc -l -p ${PORT}"
fi
echo ""
```

For examples that do NOT have branching (same command for all variants), add a single json_add_example after the echo line as normal.

For multi-line examples (e.g., "Receiver: ... Sender: ..."), use the primary command in json_add_example. If the example shows both receiver and sender commands, combine with " && " or use the listener-side command as the primary.

**3. json_finalize** before the interactive demo block.

Read each script carefully to identify which examples branch and which don't before making changes.
  </action>
  <verify>
```bash
bash scripts/netcat/setup-listener.sh -j 3>&1 1>/dev/null 2>/dev/null | jq -e '
    .meta.tool == "netcat" and
    .meta.category == "network-scanner" and
    (.results | length) >= 10
'
bash scripts/netcat/transfer-files.sh -j 3>&1 1>/dev/null 2>/dev/null | jq -e '
    .meta.tool == "netcat" and
    .meta.category == "network-scanner" and
    (.results | length) >= 10
'
```
  </verify>
  <done>Both netcat scripts produce valid JSON with correct meta fields, all examples (including variant-branched ones) captured as results.</done>
</task>

</tasks>

<verification>
1. `grep -r 'json_set_meta' scripts/{curl,dig,foremost,nikto,netcat,tshark}/ --include='*.sh' | grep -v examples | wc -l` — returns 10 (some dirs have more scripts covered by Plan 04)
2. `grep -r 'json_finalize' scripts/{curl,dig,foremost,nikto,netcat,tshark}/ --include='*.sh' | grep -v examples | wc -l` — returns 10
3. Spot-check netcat/setup-listener.sh JSON output contains 10 results with variant-appropriate commands
4. All 10 scripts produce valid JSON via `jq .` when invoked with `-j`
</verification>

<success_criteria>
- All 10 scripts have json_set_meta, json_finalize, and json_add_example calls
- Netcat scripts correctly handle NC_VARIANT branching with json_add_example in each branch
- Each script produces valid JSON output with `-j` containing all numbered examples
- Correct categories: network-analysis (curl, dig, tshark), forensics (foremost), web-scanner (nikto), network-scanner (netcat)
- No existing script behavior is altered when run without `-j`
</success_criteria>

<output>
After completion, create `.planning/phases/25-script-migration/25-03-SUMMARY.md`
</output>
