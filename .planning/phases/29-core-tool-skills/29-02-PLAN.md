---
phase: 29-core-tool-skills
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/skills/sqlmap/SKILL.md
  - .claude/skills/nikto/SKILL.md
autonomous: false
requirements: [TOOL-04, TOOL-05]

must_haves:
  truths:
    - "User can invoke /sqlmap and Claude loads the skill with SQL injection scripts"
    - "User can invoke /nikto and Claude loads the skill with web vulnerability scanning scripts"
    - "Both skills prevent Claude from auto-invoking pentesting tools"
    - "Each skill references the correct existing scripts by absolute path"
    - "User can verify all 5 core tool skills work via manual testing"
  artifacts:
    - path: ".claude/skills/sqlmap/SKILL.md"
      provides: "SQLMap skill with database dumping and WAF bypass scripts"
      min_lines: 40
      contains: "disable-model-invocation: true"
    - path: ".claude/skills/nikto/SKILL.md"
      provides: "Nikto skill with web vulnerability and authentication scanning scripts"
      min_lines: 40
      contains: "disable-model-invocation: true"
  key_links:
    - from: ".claude/skills/sqlmap/SKILL.md"
      to: "scripts/sqlmap/*.sh"
      via: "bash script references"
      pattern: "bash scripts/sqlmap/.*\\.sh"
    - from: ".claude/skills/nikto/SKILL.md"
      to: "scripts/nikto/*.sh"
      via: "bash script references"
      pattern: "bash scripts/nikto/.*\\.sh"
---

<objective>
Create the final 2 core tool skills (sqlmap, nikto) completing the 5-tool validation set, then verify all 5 skills are invocable and work correctly with Phase 28 safety hooks.

Purpose: Complete the tool skill pattern validation before scaling to all 17 tools in Phase 31
Output: 2 skill files plus human verification that slash commands work end-to-end
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-core-tool-skills/29-RESEARCH.md
@.planning/phases/28-safety-architecture/28-01-SUMMARY.md
@.planning/phases/29-core-tool-skills/29-01-SUMMARY.md
@scripts/common.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sqlmap skill with SQL injection scripts</name>
  <files>.claude/skills/sqlmap/SKILL.md</files>
  <action>
Create `.claude/skills/sqlmap/SKILL.md` following the validated pattern.

YAML frontmatter (REQUIRED):
```yaml
---
name: sqlmap
description: SQL injection detection and database extraction using sqlmap wrapper scripts
disable-model-invocation: true
---
```

Markdown body structure:
1. **H1 title**: "# SQLMap SQL Injection Tool"
2. **Brief purpose statement**: One sentence
3. **Available Scripts section** with categories:
   - Database Extraction: dump-database.sh
   - Testing: test-all-parameters.sh
   - Evasion: bypass-waf.sh
   - Learning Mode: examples.sh
4. **Flags section**: -j, -x, --help
5. **Target Validation section**: scope.json reference

Absolute paths: `bash scripts/sqlmap/SCRIPT.sh [args] [-j] [-x]`

Descriptions: "Extract database contents", "Test all parameters for SQLi", "Bypass web application firewalls"

Keep under 100 lines.
  </action>
  <verify>
File exists at .claude/skills/sqlmap/SKILL.md

grep -q "disable-model-invocation: true" .claude/skills/sqlmap/SKILL.md
grep -q "bash scripts/sqlmap/dump-database.sh" .claude/skills/sqlmap/SKILL.md
grep -q "bash scripts/sqlmap/test-all-parameters.sh" .claude/skills/sqlmap/SKILL.md
grep -q "bash scripts/sqlmap/bypass-waf.sh" .claude/skills/sqlmap/SKILL.md
grep -q "bash scripts/sqlmap/examples.sh" .claude/skills/sqlmap/SKILL.md

Line count between 40-100: wc -l < .claude/skills/sqlmap/SKILL.md
  </verify>
  <done>
SQLMap skill exists with correct frontmatter, references all 4 existing scripts by absolute path, documents -j flag and target validation, and contains 40-100 lines
  </done>
</task>

<task type="auto">
  <name>Task 2: Create nikto skill with web vulnerability scanning scripts</name>
  <files>.claude/skills/nikto/SKILL.md</files>
  <action>
Create `.claude/skills/nikto/SKILL.md` following the same pattern.

YAML frontmatter (REQUIRED):
```yaml
---
name: nikto
description: Web server vulnerability scanning using nikto wrapper scripts
disable-model-invocation: true
---
```

Markdown body structure:
1. **H1 title**: "# Nikto Web Scanner"
2. **Brief purpose statement**: One sentence
3. **Available Scripts section** with categories:
   - Vulnerability Scanning: scan-specific-vulnerabilities.sh
   - Multi-Target: scan-multiple-hosts.sh
   - Authentication: scan-with-auth.sh
   - Learning Mode: examples.sh
4. **Flags section**: -j, -x, --help
5. **Target Validation section**: scope.json reference

Absolute paths: `bash scripts/nikto/SCRIPT.sh [args] [-j] [-x]`

Descriptions: "Scan for specific vulnerability types", "Scan multiple hosts from file", "Scan with HTTP authentication"

Keep under 100 lines.
  </action>
  <verify>
File exists at .claude/skills/nikto/SKILL.md

grep -q "disable-model-invocation: true" .claude/skills/nikto/SKILL.md
grep -q "bash scripts/nikto/scan-specific-vulnerabilities.sh" .claude/skills/nikto/SKILL.md
grep -q "bash scripts/nikto/scan-multiple-hosts.sh" .claude/skills/nikto/SKILL.md
grep -q "bash scripts/nikto/scan-with-auth.sh" .claude/skills/nikto/SKILL.md
grep -q "bash scripts/nikto/examples.sh" .claude/skills/nikto/SKILL.md

Line count between 40-100: wc -l < .claude/skills/nikto/SKILL.md
  </verify>
  <done>
Nikto skill exists with correct frontmatter, references all 4 existing scripts by absolute path, documents -j flag and target validation, and contains 40-100 lines
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify all 5 core tool skills work end-to-end with safety hooks</name>
  <files>none</files>
  <action>
This is a human verification checkpoint. The user must verify that all 5 core tool skills (nmap, tshark, metasploit, sqlmap, nikto) are invocable via slash commands and integrate correctly with Phase 28 safety hooks. No automated action — the executor presents the verification steps below and waits for user confirmation.
  </action>
  <verify>
Manual testing in Claude Code conversation:

1. **Test skill invocation (each of the 5 tools):**
   - Type `/nmap` and verify Claude loads the skill with script listings
   - Type `/tshark` and verify skill loads
   - Type `/metasploit` and verify skill loads
   - Type `/sqlmap` and verify skill loads
   - Type `/nikto` and verify skill loads

2. **Verify disable-model-invocation works:**
   - Start a new conversation
   - Do NOT type any slash commands
   - Mention "I want to scan a network" in regular conversation
   - Claude should NOT auto-invoke /nmap or reference the skill descriptions
   - (Confirms skills are not in default context)

3. **Test one skill end-to-end with safety hooks:**
   - Type `/nmap`
   - Ask: "Scan localhost for open ports"
   - Claude should invoke: `bash scripts/nmap/identify-ports.sh localhost -j -x`
   - PreToolUse hook should validate localhost is in scope (or guide you to create .pentest/scope.json)
   - Script should run and produce JSON output
   - PostToolUse hook should inject a summary in Claude's response
   - Verify audit log entry: `cat .pentest/audit-*.jsonl | tail -1 | jq`

4. **Verify script references are correct:**
   - For each skill, check that listed scripts actually exist:
     - `ls scripts/nmap/*.sh` matches what /nmap shows
     - `ls scripts/tshark/*.sh` matches what /tshark shows
     - etc.

Expected outcomes:
- All 5 slash commands load their respective skills
- Skills do NOT appear in default context (disable-model-invocation working)
- End-to-end flow (skill → script → hook → output) works
- All script paths are valid (no broken references)
  </verify>
  <done>
User has confirmed all 5 tool skills are invocable, disable-model-invocation prevents auto-invocation, end-to-end flow with safety hooks works correctly, and all script references are valid
  </done>
</task>

</tasks>

<verification>
All 5 skill files exist in `.claude/skills/{tool}/SKILL.md` structure
All 5 skills have `disable-model-invocation: true` in frontmatter
User has verified slash commands work and skills don't auto-load
User has confirmed end-to-end flow with safety hooks works
All script references point to existing files
</verification>

<success_criteria>
User can invoke all 5 tool skills via slash commands (/nmap, /tshark, /metasploit, /sqlmap, /nikto)
Skills do not appear in Claude's default context (confirmed via /context or by asking about network scanning without using slash commands)
Running a skill-guided script produces JSON output that PostToolUse hook parses and summarizes
Audit log captures the skill invocation with tool, script, target, and timestamp
Tool skill pattern is validated and ready to scale to all 17 tools in Phase 31
</success_criteria>

<output>
After completion, create `.planning/phases/29-core-tool-skills/29-02-SUMMARY.md`
</output>
