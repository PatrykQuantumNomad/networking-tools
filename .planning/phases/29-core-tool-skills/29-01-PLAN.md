---
phase: 29-core-tool-skills
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/skills/nmap/SKILL.md
  - .claude/skills/tshark/SKILL.md
  - .claude/skills/metasploit/SKILL.md
autonomous: true
requirements: [TOOL-01, TOOL-02, TOOL-03]

must_haves:
  truths:
    - "User can invoke /nmap and Claude loads the skill with available wrapper scripts"
    - "User can invoke /tshark and Claude loads the skill with packet analysis scripts"
    - "User can invoke /metasploit and Claude loads the skill with exploitation scripts"
    - "All 3 skills prevent Claude from auto-invoking pentesting tools"
    - "Each skill references the correct existing scripts by absolute path"
  artifacts:
    - path: ".claude/skills/nmap/SKILL.md"
      provides: "Nmap skill with discovery and web scanning scripts"
      min_lines: 40
      contains: "disable-model-invocation: true"
    - path: ".claude/skills/tshark/SKILL.md"
      provides: "Tshark skill with packet capture and analysis scripts"
      min_lines: 40
      contains: "disable-model-invocation: true"
    - path: ".claude/skills/metasploit/SKILL.md"
      provides: "Metasploit skill with payload generation and listener scripts"
      min_lines: 40
      contains: "disable-model-invocation: true"
  key_links:
    - from: ".claude/skills/nmap/SKILL.md"
      to: "scripts/nmap/*.sh"
      via: "bash script references"
      pattern: "bash scripts/nmap/.*\\.sh"
    - from: ".claude/skills/tshark/SKILL.md"
      to: "scripts/tshark/*.sh"
      via: "bash script references"
      pattern: "bash scripts/tshark/.*\\.sh"
    - from: ".claude/skills/metasploit/SKILL.md"
      to: "scripts/metasploit/*.sh"
      via: "bash script references"
      pattern: "bash scripts/metasploit/.*\\.sh"
---

<objective>
Create the first 3 Claude Code tool skills (nmap, tshark, metasploit) as minimal navigation layers over existing wrapper scripts, validating the zero-context-overhead skill pattern.

Purpose: Enable users to discover and invoke pentesting tools via slash commands without auto-invocation risk
Output: 3 skill files with `disable-model-invocation: true`, script references, and flag documentation
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-core-tool-skills/29-RESEARCH.md
@.planning/phases/28-safety-architecture/28-01-SUMMARY.md
@scripts/common.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create nmap skill with discovery and web scanning scripts</name>
  <files>.claude/skills/nmap/SKILL.md</files>
  <action>
Create `.claude/skills/nmap/SKILL.md` following the validated pattern from research.

YAML frontmatter (REQUIRED):
```yaml
---
name: nmap
description: Network scanning and host discovery using nmap wrapper scripts
disable-model-invocation: true
---
```

Markdown body structure:
1. **H1 title**: "# Nmap Network Scanner"
2. **Brief purpose statement**: One sentence describing the tool
3. **Available Scripts section** with categories:
   - Discovery: discover-live-hosts.sh, identify-ports.sh
   - Web Scanning: scan-web-vulnerabilities.sh
   - Learning Mode: examples.sh
4. **Flags section**: Document -j (JSON output), -x (execute), --help
5. **Target Validation section**: Reference .pentest/scope.json and /netsec-health

Use absolute paths from project root: `bash scripts/nmap/SCRIPT.sh [args] [-j] [-x]`

One-line descriptions (verb phrases): "Find active hosts", "Scan for open ports", "Detect web vulnerabilities"

Keep total length under 100 lines. No raw tool commands (hooks block them). Reference research examples for exact format.
  </action>
  <verify>
File exists at .claude/skills/nmap/SKILL.md

grep -q "disable-model-invocation: true" .claude/skills/nmap/SKILL.md
grep -q "bash scripts/nmap/discover-live-hosts.sh" .claude/skills/nmap/SKILL.md
grep -q "bash scripts/nmap/identify-ports.sh" .claude/skills/nmap/SKILL.md
grep -q "bash scripts/nmap/scan-web-vulnerabilities.sh" .claude/skills/nmap/SKILL.md
grep -q "bash scripts/nmap/examples.sh" .claude/skills/nmap/SKILL.md

Line count between 40-100: wc -l < .claude/skills/nmap/SKILL.md
  </verify>
  <done>
Nmap skill exists with correct frontmatter (disable-model-invocation: true), references all 4 existing scripts by absolute path, documents -j flag and target validation, and contains 40-100 lines
  </done>
</task>

<task type="auto">
  <name>Task 2: Create tshark skill with packet analysis scripts</name>
  <files>.claude/skills/tshark/SKILL.md</files>
  <action>
Create `.claude/skills/tshark/SKILL.md` following the same pattern.

YAML frontmatter (REQUIRED):
```yaml
---
name: tshark
description: Packet capture and network traffic analysis using tshark wrapper scripts
disable-model-invocation: true
---
```

Markdown body structure:
1. **H1 title**: "# Tshark Packet Analyzer"
2. **Brief purpose statement**: One sentence
3. **Available Scripts section** with categories:
   - Credential Capture: capture-http-credentials.sh
   - Analysis: analyze-dns-queries.sh, extract-files-from-capture.sh
   - Learning Mode: examples.sh
4. **Flags section**: -j, -x, --help
5. **Target Validation section**: scope.json reference

Absolute paths: `bash scripts/tshark/SCRIPT.sh [args] [-j] [-x]`

Descriptions: "Extract HTTP credentials from traffic", "Analyze DNS query patterns", "Carve files from packet capture"

Keep under 100 lines.
  </action>
  <verify>
File exists at .claude/skills/tshark/SKILL.md

grep -q "disable-model-invocation: true" .claude/skills/tshark/SKILL.md
grep -q "bash scripts/tshark/capture-http-credentials.sh" .claude/skills/tshark/SKILL.md
grep -q "bash scripts/tshark/analyze-dns-queries.sh" .claude/skills/tshark/SKILL.md
grep -q "bash scripts/tshark/extract-files-from-capture.sh" .claude/skills/tshark/SKILL.md
grep -q "bash scripts/tshark/examples.sh" .claude/skills/tshark/SKILL.md

Line count between 40-100: wc -l < .claude/skills/tshark/SKILL.md
  </verify>
  <done>
Tshark skill exists with correct frontmatter, references all 4 existing scripts by absolute path, documents -j flag and target validation, and contains 40-100 lines
  </done>
</task>

<task type="auto">
  <name>Task 3: Create metasploit skill with exploitation scripts</name>
  <files>.claude/skills/metasploit/SKILL.md</files>
  <action>
Create `.claude/skills/metasploit/SKILL.md` following the same pattern.

YAML frontmatter (REQUIRED):
```yaml
---
name: metasploit
description: Exploitation framework wrapper scripts for payloads, scanning, and listeners
disable-model-invocation: true
---
```

Markdown body structure:
1. **H1 title**: "# Metasploit Framework"
2. **Brief purpose statement**: One sentence
3. **Available Scripts section** with categories:
   - Payload Generation: generate-reverse-shell.sh
   - Network Scanning: scan-network-services.sh
   - Listeners: setup-listener.sh
   - Learning Mode: examples.sh
4. **Flags section**: -j, -x, --help
5. **Target Validation section**: scope.json reference

Absolute paths: `bash scripts/metasploit/SCRIPT.sh [args] [-j] [-x]`

Descriptions: "Create reverse shell payloads", "Identify services and versions", "Configure handler for reverse connections"

Keep under 100 lines.
  </action>
  <verify>
File exists at .claude/skills/metasploit/SKILL.md

grep -q "disable-model-invocation: true" .claude/skills/metasploit/SKILL.md
grep -q "bash scripts/metasploit/generate-reverse-shell.sh" .claude/skills/metasploit/SKILL.md
grep -q "bash scripts/metasploit/scan-network-services.sh" .claude/skills/metasploit/SKILL.md
grep -q "bash scripts/metasploit/setup-listener.sh" .claude/skills/metasploit/SKILL.md
grep -q "bash scripts/metasploit/examples.sh" .claude/skills/metasploit/SKILL.md

Line count between 40-100: wc -l < .claude/skills/metasploit/SKILL.md
  </verify>
  <done>
Metasploit skill exists with correct frontmatter, references all 4 existing scripts by absolute path, documents -j flag and target validation, and contains 40-100 lines
  </done>
</task>

</tasks>

<verification>
All 3 skill files exist in `.claude/skills/{tool}/SKILL.md` structure
All 3 skills have `disable-model-invocation: true` in frontmatter
All script references use absolute paths (`bash scripts/{tool}/*.sh`)
All skills document the `-j` flag prominently for JSON output
All skills reference target validation and `/netsec-health`
Each skill is 40-100 lines (minimal navigation layer, not documentation)
No raw tool commands embedded (hooks would block them)
</verification>

<success_criteria>
User can invoke `/nmap` and see a skill description listing discover-live-hosts.sh, identify-ports.sh, scan-web-vulnerabilities.sh, and examples.sh
User can invoke `/tshark` and see credential capture and analysis scripts
User can invoke `/metasploit` and see payload generation, scanning, and listener scripts
Claude never auto-invokes these skills (disable-model-invocation prevents it)
All scripts use the existing wrapper scripts (no modifications to scripts/ directory)
</success_criteria>

<output>
After completion, create `.planning/phases/29-core-tool-skills/29-01-SUMMARY.md`
</output>
